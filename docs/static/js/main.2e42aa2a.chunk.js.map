{"version":3,"sources":["audio/Weapons/Lasers/sfx_wpn_laser1.wav","assets/enemy/enemy-explosion-00.png","assets/enemy/enemy-explosion-01.png","assets/enemy/enemy-explosion-02.png","assets/enemy/enemy-explosion-03.png","assets/enemy/enemy-explosion-04.png","assets/enemy/enemy-explosion-05.png","audio/Explosions/Long/sfx_exp_long1.wav","audio/Music/game-menu.mp3","audio/Music/game-main.mp3","audio/Music/game-end.mp3","audio/Music/game-main-summary.mp3","audio/General Sounds/Fanfares/sfx_sounds_fanfare1.wav","audio/General Sounds/Positive Sounds/sfx_sounds_powerup3.wav","audio/General Sounds/Fanfares/sfx_sounds_fanfare3.wav","audio/General Sounds/Positive Sounds/sfx_sounds_powerup2.wav","audio/General Sounds/Interactions/sfx_sounds_interaction1.wav","audio/General Sounds/Pause Sounds/sfx_sounds_pause1_in.wav","audio/General Sounds/Pause Sounds/sfx_sounds_pause1_out.wav","audio/Weapons/Cannon/sfx_wpn_cannon1.wav","audio/Explosions/Short/sfx_exp_short_soft5.wav","audio/Explosions/Short/sfx_exp_short_hard12.wav","audio/Explosions/Clusters/sfx_exp_cluster1.wav","audio/Explosions/Odd/sfx_exp_odd1.wav","assets/player/ship.png","assets/player/explosion-1/explosion-1-01.png","assets/player/explosion-1/explosion-1-02.png","assets/player/explosion-1/explosion-1-03.png","assets/player/explosion-1/explosion-1-04.png","assets/player/explosion-1/explosion-1-05.png","assets/enemy/enemy-ship.png","assets/crab-bug/crab-bug-ship.png","assets/helmet-bug/helmet-bug-ship.png","assets/pincer-bug/pincer-bug-ship.png","assets/sonic-enemy/sonic-enemy-ship.png","engine/utils.ts","engine/components/nameable.ts","events.ts","engine/components/killable.ts","engine/components/withGeometry.ts","engine/components/withRandomWalk.ts","engine/components/isCollidable.ts","engine/components/lootable.ts","engine/components/withBoundary.ts","engine/components/withTexture.ts","engine/components/withBugWiggle.ts","engine/components/withPosition.ts","engine/components/withHomePosition.ts","engine/components/withWrapAroundPosition.ts","game/factories/enemy.ts","game/Domain/mob.ts","game/catalogue.ts","client/Hoc/withEntity.tsx","client/hooks/withAnimationState.ts","client/hooks/withSoundEffects.ts","client/hooks/withDeathState.ts","client/Hoc/withSpriteEffects.tsx","client/Containers/Player/Player.tsx","client/Containers/NPCs/Bug.tsx","client/Containers/NPCs/CrabBug.tsx","client/Containers/NPCs/HelmetBug.tsx","client/Containers/NPCs/PincerBug.tsx","client/Containers/NPCs/SonicBug.tsx","client/Containers/Sprites.ts","client/Hoc/withTexture.tsx","client/utils.ts","client/Development/FPS.tsx","client/Development/Dev.tsx","client/Layouts/Base.tsx","client/Components/Lives.tsx","client/Components/HighScore.tsx","client/Components/Credits.tsx","client/Components/LevelStatus.tsx","client/Components/RestartButton.tsx","client/Layouts/Gui.tsx","client/Backgrounds/NewGame.tsx","extern/Key.js","extern/Keyboard.js","client/hooks/withEnterKeyEffect.ts","client/Containers/Menu.tsx","client/Backgrounds/StarField.tsx","client/Levels/Base.tsx","client/Containers/Weapons/Bullet.tsx","client/Hoc/withGameLevel.tsx","client/Levels/Directory.ts","client/Levels/Demo/Demo.tsx","client/Levels/1/Level.1.tsx","client/Levels/2/Level.2.tsx","client/Levels/3/Level.3.tsx","client/Levels/4/Level.4.tsx","client/Levels/End/End.tsx","client/Components/Countdown.tsx","client/Levels/Loader.tsx","client/Components/LevelSummary.tsx","client/Containers/Game.tsx","client/Backgrounds/GameOver.tsx","client/Containers/Outro.tsx","engine/components/combatable.ts","engine/components/withPlayerControls.ts","engine/components/withCollisions.ts","game/factories/player.ts","game/Domain/character.ts","engine/components/withMomentum.ts","engine/components/withOffscreen.ts","game/factories/bullet.ts","game/Domain/projectile.ts","engine/services/AudioManager.ts","engine/services/ComponentManager.ts","engine/services/EntityManager.ts","engine/services/EventManager.ts","extern/Vector2.js","extern/Mouse.js","engine/services/InputManager.ts","engine/services/StorageManager.ts","engine/components/controllable__OLD.ts","engine/components/index.ts","engine/components/ageable.ts","engine/services/SystemManager.ts","game/index.ts","game/factories/system.ts","App.tsx","index.tsx"],"names":["module","exports","__webpack_require__","p","createSelector","path","system","entity","searchResult","components","filter","o","b","id","state","undefined","hasState","length","first","createSetter","selector","component","factory","config","array","defaultIdGenerator","epoch","arguments","next","keys","Object","once","fn","called","apply","clamp","min","max","num","ifStateProp","obj","boxMullerRandomGeneratorFactory","random","x1","x2","w","z","phase","Math","sqrt","log","throttle","wait","last","isCalled","setTimeout","KeysEnum","defaultBoundary","top","left","bottom","right","nameableFactory","events","registerComponent","name","entityId","update","ON_START_GAME","ON_GAME_OVER","ON_LEVEL_LOAD","ON_LEVEL_BEGIN","ON_LEVEL_COMPLETE","ON_PLAYER_ATTACK","ON_COLLISION","ON_REVIVE_PLAYER","ON_DEATH","ON_ENEMY_DEATH","ON_PLAYER_DEATH","ON_ENEMY_FREE","ON_START_ENGINE","ON_STOP_ENGINE","COMPONENT_NAMESPACE","killableFactory","health","isDead","immortal","wasDeadBefore","isDeadNow","value","onChange","withGeometryFactory","geometry","width","height","defaults","direction","x","y","moving","speed","disabled","jitter","withRandomWalkFactory","randomWalkGeneratorX","randomWalkGeneratorY","options","controls","setJitter","level","deltaX","deltaY","_component$state$dire","handleMovement","isCollidableFactory","collidable","collisionGroup","lootableFactory","loot","withBoundaryFactory","boundary","geometryComponent","getEntityComponent","positionComponent","_geometryComponent$st","clampedX","position","clampedY","withTextureFactory","texture","BRAKE","PULSE_WIDTH","withBugWiggleFactory","wiggling","wiggleState","counter","increment","_component$state$wigg","handleBugWiggle","withPositionFactory","objectSpread","center","controllable","_controls$state","handleMovementState","withHomePositionFactory","homePosition","goHome","moveable","_component$state$home","distX","distY","abs","TIME_TO_GET_HOME","isHome","withWrapAroundPositionFactory","boundaryComponent","_positionComponent$st","createEnemy","textureId","withName","withHealth","withGeometry","withBoundary","withBugWiggle","withRandomWalk","withPosition","withWorldWrap","withHomePosition","isCollidable","withTexture","isLootable","registerEntity","createMob","points","SpriteTextureIds","mkAudioSrc","src","opts","Sfx","NEW_GAME","GAMEOVER","YOU_WIN","LEVEL_WIN","PAUSE","UNPAUSE","NEXT_LEVEL","Songs","MENU","GAME","END","SUMMARY","SongLibrary","_SongLibrary","defineProperty","MenuMusic","volume","MainMusic","EndMusic","SummaryMusic","SfxLibrary","_SfxLibrary","GameOverSound","LevelWinSound","NextLevelSound","YouWinSound","NewGameSound","PauseGameSound","UnPauseGameSound","withEntity","Component","props","rest","objectWithoutProperties","model","getEntityModel","react","assign","withAnimationState","_useState","useState","animations","_useState2","slicedToArray","_useState3","currentFrame","currentState","frame","getDefaultFrame","_useState4","setCurrentFrame","_useState5","_useState6","setCurrentState","_useState7","_useState8","lastState","setLastState","_useState9","_useState10","timers","setTimers","queueFrame","when","push","buffer","forEach","_ref","duration","timer","onFinished","concat","fr","withSoundEffects","playDeathAudio","collectionKey","mkAudioCollectionKey","audio","playSound","playAttackAudio","useEffect","registerListener","sounds","map","key","registerSound","unRegisterListener","actionType","unRegisterSound","action","withDeathState","dead","setDead","handleDeathEvent","deathEvent","collisions","indexOf","handleRevivePlayerEvent","withSpriteEffects","_React$useState","React","_React$useState2","hidden","setHidden","_React$useState3","_React$useState4","_withAnimationState","deathState","setStateToDead","styles","backgroundImage","backgroundSize","backgroundPosition","display","cssDisplayValue","elementId","className","style","ConnectedPlayer","normal","require","death","shoot","ShootSound","DeathSound","AnimatedBug","AnimatedCrabBug","AnimatedHelmetBug","AnimatedPincerBug","AnimatedSonicBug","SpriteTextureCollection","_SpriteTextureCollect","Player","Bug","CrabBug","HelmetBug","PincerBug","SonicBug","ConnectedComponent","loadLevel","enemyPositions","enemies","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","row","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","enemyTypeId","JSON","stringify","err","return","withBlur","handler","event","currentTarget","blur","FPS","_React$Component","_getPrototypeOf2","_this","classCallCheck","this","_len","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","lastLoop","Date","getMilliseconds","count","fps","throttled","countFps","currentLoop","loop","requestAnimationFrame","setFps","setState","updateFrequency","inherits","createClass","cancelAnimationFrame","defaultProps","EntityInspector","DevScreen","setEntityId","open","setOpen","dragging","setDrag","setDragFalse","handleClick","react_draggable_default","a","onMouseUp","onMouseDown","onMouseMove","onClick","classNames","Link","to","Buttons","FPS_FPS","e","parseInt","getState","entities","onStart","onStop","onTick","onSave","onLoad","classes","join","Layout","topLeft","topCenter","topRight","middleLeft","middleCenter","middleRight","bottomLeft","bottomCenter","bottomRight","background","children","after","Lives","HighScore","Credits","LevelStatus","RestartButton","Gui","lives","score","credits","onRestart","NewGame","Key","pressed","justPressed","justReleased","Keyboard","actions","i","window","keyCode","DOWN","UP","addEventListener","RESET","prototype","set","reset","end","shift","keyPressed","keyJustPressed","keyJustReleased","dispose","removeEventListener","TAB","ENTER","SHIFT","CTRL","ALT","CAPS_LOCK","ESC","SPACEBAR","PAGE_UP","PAGE_DOWN","HOME","INSERT","DEL","LEFT","RIGHT","NUM0","NUM1","NUM2","NUM3","NUM4","NUM5","NUM6","NUM7","NUM8","NUM9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","withEnterKeyEffect","onEnter","enterKeyHandler","document","Menu","ready","setReady","handleStartGame","emit","playSong","stopSong","Backgrounds_NewGame","StarField","Level","_React$PureComponent","Bullet","outline","borderRadius","offscreen","getStyles","ENEMY_FREE_INTERVAL","withGameLevel","LevelHOC","levelId","enemiesDead","handleDeath","find","onLevelComplete","completeEvent","stopFreeEnemyInterval","enemyFree","items","maybeComponent","floor","controlComponent","stopAllFreeEnemies","enemyGroup","startFreeEnemyInterval","interval","setInterval","clearInterval","_this$props","nextProps","nextState","unRegisterEntity","_this$props$state","player","bullet1","bullet2","Base_Level","enemy","ConnectedEnemy","Levels","demo","level1","level2","level3","level4","_props$state","humanizedLevelNames","Countdown","time","setTime","_loop","onReady","retries","Loader","levels","setRetries","_React$useState5","currentLevel","_React$useState6","setLevel","GameLevel","current","getThisLevel","onRevivePlayer","LevelSummary","onNextLevel","shots","hits","round","Game","complete","completed","registerEvents","handleLevelLoading","handleLevelBegin","handleLevelComplete","onPlayerDeath","onPlayerRevive","onEnemyDeath","handleGameOver","handleCollision","unRegisterEvents","getBullet","fireBullet","pos","bullet","reviveEntity","killEntity","Infinity","source","homePositions","location","startNewGame","nextLevel","getNextLevel","attacking","_this$state","Backgrounds_StarField","GameOver","Outro","final","setFinalScore","serialized","qs","tokens","searchString","split","params","re","exec","decodeURIComponent","getQueryParams","search","parse","clearTimeout","Backgrounds_GameOver","combatableFactory","attackPower","input","KeyCodes","handleAttack","withPlayerControlsFactory","handleVerticalMovement","handleHorizontalMovement","handleMovingFlag","_ref2","neg","withCollisionsFactory","collidableEntities","getEntitiesByComponentTypes","ownBounds","getBounds","otherBounds","lastCollisions","arrayToCompareTo","comparedArray","sorted1","sort","sorted2","diff","handleCollisions","dimensions","createPlayer","withControls","withAttack","withCollisions","createCharacter","withMomentumFactory","momentum","_component$state$mome","withOffscreenFactory","screenSize","innerWidth","innerHeight","handleOffscreenFlag","createBullet","withMomentum","withOffscreen","createProjectile","configDefaults","debug","logging","version","AudioManager","init","toString","songs","soundFactory","Howl","audioEngine","Howler","stop","unload","sprite","Error","callback","on","off","ComponentManager","idGenerator","unRegisterComponent","componentId","get","getSerializableState","loadHydratedState","EntityManager","EventManager","emitter","addListener","removeListener","eventName","data","_emit","onUpdate","_this$emitter","console","EventEmitter2","delimiter","wildcard","maxListeners","Vector2","Mouse","_keys","_position","_positionUpdated","_delta","_wheel","_wheelUpdated","_doubleClicked","delta","wheel","doubleClicked","canvas","self","onmousewheel","detail","navigator","msMaxTouchPoints","lastTouch","touch","touches","clientX","clientY","updateKey","rect","getBoundingClientRect","updatePosition","movementX","movementY","which","MIDDLE","setCanvas","mouseInside","insideCanvas","setLock","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","exitPointerLock","mozExitPointerLock","webkitExitPointerLock","buttonPressed","button","buttonDoubleClicked","buttonJustPressed","buttonJustReleased","xDiff","yDiff","InputManager","mouse","keyboard","StorageManager","saveGame","saveState","loadGame","loadedFromStorage","loadStateFromKey","hydratedComponents","hydrateLoadedComponents","localStorage","setItem","getItem","_this2","componentInitializerCache","componentInitializer","cached","getComponentFactory","defaultComponentFactories","age","attack","wiggle","worldwrap","SystemManager","epochs","object","entityModelCache","entityComponentCache","entityManager","registered","componentManager","entityComponentSetter","getComponent","getComponentById","getComponentIdsForEntity","entityComponents","getComponentsForEntity","componentFactories","getCachedComponentsForEntity","entityModels","unRegisterComponentsForEntity","deleteEntityComponents","clearEntityComponentCache","clearEntityModelCache","componentName","reduce","acc","val","groupEntityComponents","componentNames","cacheKey","isValidComponent","step","updateSystemEntities","updateComponentsForEntity","updateComponent","storage","n","setValue","_ref$version","_ref$logging","createSystem","App","gameAudioInitialize","registerSong","gameAudioCleanup","unRegisterSong","moUntWOrld","tick","_","start","_update","save","load","restart","BrowserRouter","Route","exact","render","Game_Game","Dev_DevScreen","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.2e42aa2a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/sfx_wpn_laser1.7c857ee1.wav\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAjklEQVRYR+2WQQrAIAwENz9p/v+o9CeWQANSvLiUBsp6FExmJyIampc194cAZEAGZOA/BiJiuPt2oO0D9XSzDZ9PPw2QhRLicMcZASZ91qAAKv0ARjZPCAOMsUIBzGMoA7nHWKAAKmmN4Fb5rYEZgk1P34HVJ4aZ/6sA7M+KugNss9U5AciADMiADLQbuADnnjshOGarxwAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA4UlEQVRYR+2UwQ3EMAgEoZPQf1G4E59AwUK+ewCXyB/8ipSEXQYvCIcPHtaHNtAEmsAjBJh5ElGpVumnfwT3vZMyMCdMKYAIaCa8GXkv7zLLLfWxFPYiu4nXDXwJwk0Ecl17QmECO2orYuO4iGAwg1zGCTAxaCpswASl+OpAnlyFqGiJgP9JLyOCdnxdpCZMPJuQMAHDKgKCe+tC62TFNVGZyKwx3HEcg8HMrPkno5gyoN0Lcnf8TrCY2q6INJcy8IuAreAK/voIXMyqwivGEUxvflMawZOG2kATaAJN4DiBDzrKfCHGS/waAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABAklEQVRYR+2VSw4DIQhA4Sbj/Q/lUWyw0jCIBWya2dhNMz95Pj4iPPzDh+PDATgGjgHXQK21lVKm9/T9BtAQ8l3lAsg5IYO2Bg0RUN7bgUoBEAzvVO6YYOgZAdH/ypo19EIAt513hjcJB+yXw0g2FSEAi9xLQdRCCsCqAUt5NHhPm3cYkdLx4pTfVdGxHW/tEAAvEln0U6BGh6xgXAPywxXEt1b0LLgAOu+cNBo6mVz/bICDZSxEAF0DFjkvbBUhF2ykZsJFqANNgcUQ+gsAW6DA11X6pTUFvYLbHsW6FXn2axAdIJIGtwZuh844cnW/Zw8gCeoC7GjNfHMAjoFj4HEDL4r0ziE3SigHAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABW0lEQVRYR91WWw7EIAjEm9T7H8rexA1NbCzyGNwmm2z/2iIMwzha6MdP+XF9ggB0ol4Ii802BAHIJs3EpwH0Tp0LlPJkpLXWa61Lvoi9NACtO1k8KjrnCAFYnXES7Z8Xr4EPAYxFSGIkRoJQAVhzHotnineKqiOIEjGoIbxoxhmA7ggGKI0R/ncc9WrmBjaBRLcirIEooWTQYlR+fw3ArQ/hE9FoHwDkbPn9bI00g/EYmfWiCdf1gRlxJDZOhAjOY8EcgdZFRKcEFOnmErAVNAAgRT17jjzlAWC3GNKpNU6bAecO4G0xBiNFu6UBpCsrJsNkqAHr1NOKS+EiQMzDaNird9ZfdlwrK/nKo+5/4wIzGkg5IbozEP+AACzO2Kmf5+qMu56x+ADiatYFZfd2lBqBFJ5WVGPD21EwAETRlhBfAWBRv+P/7mn4jQHtrIVHgCRHx/S/DCAsyZgPlF0MMIC1WsUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABEElEQVRYR81XWxLDIAiEo+T+h9Kb2DEdM2pFF3yk/Q3iviAN08QvEAUm4okW+OEQKDBj9c65cF2XCCx//hSNDmkAaBQpUKKXjMBKAFrnpvzTMJVquwBiyLxz1PMzNkaVa4F4TYEEeisAJCvwFCT5kKaabGxVIAci5eQYANMUaKQs2CpWtKjAij2PEIAsmJlzCUQiCAFAmFhrOLKLh9E3neYiZGR/FNjpfSTrfbnaj1rQytJRAH/1Mkpgmgog4dGEsVf7igV5Fvgk2+MZQMiZLFi5mk0AVgXw3sCtZrV0iJRWUGoFRmDq5/Vqr+27AfT2/0q/k0rFGFqls/4Dqu97LNjBNL9Msu5rgeLLd4VieY8P2WaPIboXUNsAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAs0lEQVRYR+2XSw6AMAgF4SZy/0P1KBiMIDV+YuKzLnCljSnTwZgHU7qUSJmI8xr6viuGArjaNwDsJT8twsLZ/h0AayNlsR683obFwsH+XaHWmorI68XNrBswCOKtxmcA+WPOBx0CYDAOMQzAISD9fvLvKIAyUAbKQBkoA2XgPwZQkfwuG/SpGJCG9wARTtdaCwByJrDslyFksnwusRQAyJlgP/7Zs88e0QLkTHD1HRTAcAMzqEdXu+U9kUQAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/sfx_exp_long1.e65a7e8b.wav\";","module.exports = __webpack_public_path__ + \"static/media/game-menu.277a07d7.mp3\";","module.exports = __webpack_public_path__ + \"static/media/game-main.62197df4.mp3\";","module.exports = __webpack_public_path__ + \"static/media/game-end.4f698af1.mp3\";","module.exports = __webpack_public_path__ + \"static/media/game-main-summary.430d3f4f.mp3\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_fanfare1.aae78736.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_powerup3.da47f034.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_fanfare3.25f989ff.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_powerup2.35e9b099.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_interaction1.60988248.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_pause1_in.b7b7a7b9.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_sounds_pause1_out.959daf2a.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_wpn_cannon1.75bcd782.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_exp_short_soft5.c6e20b31.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_exp_short_hard12.ffa98eb5.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_exp_cluster1.7a7460e6.wav\";","module.exports = __webpack_public_path__ + \"static/media/sfx_exp_odd1.6d3db534.wav\";","module.exports = __webpack_public_path__ + \"static/media/ship.8745c391.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABvElEQVRYR+1XW5LDIAwjN1nufyj2Jt6BYlYYv5LpTH/an6YktYQsY+cqH/5c78RvrVGt9VbMWw8PstRofF8CqK/3Neu+sdM8ARkYf8/r9vtCGSowoUDimIAA7jIvEFaEd26p4pDwCcAuqBS6SokJT7BF9EdJFxAKCdBVO2oaeIiCZINU2IGp0QI3gpiqcNo0s4p0uASW0+8SQG/I6xQBatQd3d3s1balwJECRwldAahpJiKN3EF4LeMRayOuuaLdZwhEhrQVUGTDYJoCrin5jBB+OghEu2a5nxBYsYHEqcC8qe2G1xAc0+Caktp//zAJYEOZkknZuwIZAgcZJfbI8ubuBIGofWOK1OqwPMBnNwNwX7eMZxHxCGj+eingnNde3j0S2cNIJyC6YCR7pAbftxUopWAKKrRQWW6aAWUlyAOKgV0CKxXz39wJGVDWP1cDVoX2TA+3AUcH0TbTYUtWdPaGFPTOIJYqQwA5Rq+HRnjWCxBMm3K1AVXOg8mZIBzJeCjxjmZZytI3Xn+JZz1lKt5ePsBU2yCKKmrqzPsxAQ7kvXDgDNhdj+8HgXfyBBImfGLctxJIcDwe+RL4A6hvfDDjUhdcAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACBUlEQVRYR8VXQXLEIAyDnyz/fxT7EzpmMRXCBmdmO82lmSTFsizZ3pz++cozfqut3+fy++yvwEGsPZi8PIFAoHrPwE9nUKJ2th4bGNBiB4C3lFpOaWeYwPp0jyyWgxhALnm+t0AzWwaz53ojlXDYElQO9UoxWKq1tlJsbcVLMILUd0r9sFs5gGoBoBVjIDHFKxNWUGSA2Qi4agNwFQ+A6Gy8gl51nOX3ASNbCWhdQivS/Col5VY/PYXFSXo5a0ApHCXQIFpHDCqfKhBhpeULiMGI3Yg0TchAxaeK5r/yLxMgluXEQi7ZB0CCYvpntoN+LkPXhmFRtmQYgBy2ZDgoFNG+a/1YE33P4ryKENUV6fdAOQtzgrk0qC6xTdVGcBGUZImXUi6KZwZUD5tFQ62YUbfaGADTLQG79VJa7OjpABM5u0BrOvyPQruJsNtSdWA5YZx97wPQC9QJGJxLqEJdSnPQwmMAFv0WM3P4sB1xhG8idMavtlNsRpYgl2dGYKuN31cyZyZMisHvAnB5bu0KtK7Fx3Fw6M3PDsI7u0DeehMsMvsNwfEQu9twNIylb0dA4fTU+9Exn61kQoJutZYwuRzWJgQA+ufOqm5qYNuEsYVac8J7T0Ct5fTugqfi46HG/f/oAoemBYPx28DEeDoLWIzZ0MoqAjbA3jMAXwp67wMB5N/65Afslf0wgQfXLAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACd0lEQVRYR51XQYIDIQjTn9T/P8r+ZHaxYEMMs+320tZhAEOC2Ns3n2tey7yPvr7jP/qwZ7we9hzrmtfb0Y2RzFEFutsM+7ck++ivBGI3yqhyWiUQ6330OV+IjYc7wXc8Vk4ggoHhfL4Wx6hhRxsLarb4vZOADV6tGfyAgJXUF7G+5jwc7kSueUXQyBltELSdDKCAcd4ICKhtF48x2nPO9DQl9GjtSIbWFnpM4KjKEdcN2WnAiOuWnH04QWW7kyCeZQQAWoQOg25CeeZcItwQopdQMKOKhEfNBcSMmkrWgvdrrvIwP1AVqaF8Gvxw6Kw/ElP8ID7kjgba5TreBf0kIdv12qCpAWR+m0AFNdc2Gk7IdDcgQGYncIcAluAgUGuNm0wkGOvpf+w4mhKUAwmZOuHuaGgMjiwABlO/EQ1GBJtW9IWjFUedZDLejlW7jVZdlUMFX2pMdfYTagUA0iTyhP79oEmOi2dVcH0aij6PUKrWfEfKePZVI+Ig+yQUHNgHFEnm4EIcRtAFcwnoDIgSlF0P+IBJcOANP88E5TxAg0Q6B4iELMNEQFBStOVlT0PJSUKD2YeQv3bPz0Omav2YivroPheQOSgB2zHzQGlcSTF87EHWFjyGliEhUE06mABPTNiK1/bUMOJrH5UAAygZKjRK7ZcqiDeKWZ/ZXSViblRfSIMMTEUbATWQJna4Oiq4JfFoTkhE9BfuLyaIBsqTegDCHW1cJbRlCA+PqVgiQZeQSqab8az3COjQI0klCVWm8h7oiuExPUmOoODZIXHAdVnfFQo5yalZ3DUD3fNiUlwayjreKYbgLn3sy+l/g6PnT6/jnM3vez/v0LVIfdTdDwAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACFUlEQVRYR8VXQY7EIAyDnwz/fxTzE1ahBJnghLLSaudSTVsSx3EMzemff7nnb7X1ay7P/z/81frkKuXJtSRsKbVs7iEWXCzvfmtN5WOASzFeIaTQrWKLUAHI/Z4spVS/O0Va0WQUQChYrFwjUMp7slKyXnvSQV0PMqrG92xwy5bHrNtzlhxBzeeDVmFlYWGUiHGYtF61YKl+MPMpJeVWl5jYGgVj11oQR9VbmjGAMjLpb7UxENFQLQA2uiCgJpPKRf3eT/TR2wHXaLypDyBtJ0tAFuRdBTj1AmPK2uFqQGn1lG5BMoY8ECjWFQChXBlgE+CNqV2DIzoNjDmhWLKOU9QGD4wnUAXAnHYXIZgMqwSrEZB9HMG+t9ZYqzai2jSAFEUz7DFk53/bK0IArbaWn4retAAZwrhsLXNJWfNahCwZc0irg6krpxUUgJpI5HoqqMgpl1F+BcDsehiAjaM1Kc8bepwbAMjA5vewy1mAnhnheNtRnC1Y9gHHD6ztMoYiE2K2/nozWvQQnIwWsWohSj85rh23Y6WPofd2Rq9tRwbkhe1MCAdJfBYJzrol/rcg3BZ4mugBCChv5K6PZMoCO5Tqqbi/M07G3eHgXMhGLgJBzwPo52ihrAX2uev9zvfC1YcJE5F7jyQMt+PTVxEKlO0LC5Dg68iK/DyGEBl939vdrljadsNg9UnNt4n1/SsGfpskWvcD7otZP/TRmLkAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAu0lEQVRYR+2X3Q2AIAyEj1HYzg2cwQ3crm6CQUFb42/i6Uv7BiHl61GSa4CORhL6GMweeWEvYwGc5F0B8qEaDBUO8hsAaYHYAZRnaCTt5TdPkIAUAE4PFAUmiLj22XcAqpl1ob8AZJYK8RuAgiB/9Iv0nIZ7UJMDuAKugCvgCrgCroB1xQw3fNsPsGaCLUC156XYWQHiTJC9n2YYRGbrX2IBoM4E2/Evr40CyqU+cFOvHF2akDqUnKA6wAgOWExlxHkIvQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAYAAAB4d5a9AAAAwklEQVRIS+2UUQ7EIAhE4Si9nT3R9nYehQ0IDau1YrPxq8SkPzjPGUgRFhQuYMALmUr5Pq6UCY7tp4cICLGK+aLPv2I8ExVgcZEmAPsKbABg2BjCXSkTHVt5nEH4cspQO73KMQZhbXZSVRNbZ1IxCEfCoI+6YRd7LpLVzJ45UYBALDKLyhQHoPF2OSEqE5FCPu4Bd476EC+gsfi5nJvl8+k4ikH0cuNEN+/k/AOiG0wSlVUgsth2Tf1E2uYXMhXgkri+xNVLFbLUHXYAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAm0lEQVQ4T+2UQRLDIAhF/z+Kh0kPnRwmRyFDFWvRatO6yCJu0AHf8AElJi5OZOGGxWoKIARotlfjumayCxiIZCuY85fwNswiFKrZrRA+UrMU5vz52EzbLjBQQTlYgYXP322PxlTYU1uUI1t4qVr2uE/yv8usiKpkdto5fAF/w96657v5S2Yl0MM/8boyTWKescEXM6zZmS/qurAD5VJKFMb8mZ4AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAjUlEQVQ4T9XUwQ2AMAgFUBil+w/VUb5BxRCEFhMucqz15ResTI3FjRb9HQOBeH+K2jE7MNCEDIgxCDzPWTGNNED6wEI68R24xCSRFFjSXaSAWboYkx6ZstizHAxkiwmkpenu5r3efWMu1fKGuHQ5phst7tdKmO9H9J0Fa3GyNixqUscN+Pp7qt3NotqKHVslNhRW8lxOAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","import { ITypes, IEntity, IdGeneratorFunc, ISystem, IComponent, IComponentEvents, AnonymousCB, EntityIdType } from \"./types\";\n\nexport const pp = (obj: object | null | undefined) => JSON.stringify(obj, null, '  ')\n\nexport type Setter<T> = (system: ISystem, entity: IEntity, state: T) => null | undefined;\n\nexport type Selector<T> = (system: ISystem, entity: IEntity) => null | IComponent<T>\n\nexport function createSelector<T>(path: string): Selector<T> {\n  return (system: ISystem, entity: IEntity): null | IComponent<T> => {\n    const searchResult = system\n      .components\n      .filter(o =>\n        isSameEntity(o, entity)\n        && hasState(path, o.state));\n\n    if (searchResult.length === 0) {\n      return null;\n    };\n\n    return first(searchResult);\n  }\n}\n\nexport function createSetter<T>(selector: Selector<T>): Setter<T> {\n  return (system: ISystem, entity: IEntity, state: T) => {\n    const component = selector(system, entity);\n\n    if (component === null) {\n      return component;\n    }\n\n    component.state = state;\n  }\n}\n\nexport function hasState(path: string, state: any) {\n  return state[path] !== undefined;\n}\n\nexport function factory<T extends ITypes>(config: T): T {\n  return config;\n}\n\nexport function mkEntity(id: EntityIdType): IEntity {\n  return { id };\n}\n\nexport function isSameEntity(a: IEntity, b: IEntity) {\n  return a.id === b.id;\n}\n\nexport function values(obj: any) {\n  return Object.keys(obj).map(key => obj[key]);\n}\n\nexport function first<T>(array: T[]): T {\n  return array[0];\n}\n\nexport const defaultIdGenerator = (genesis: number = 0): IdGeneratorFunc => {\n  let epoch: number = genesis;\n  return () => ({ next: () => epoch++ })\n}\n\nexport const defaultComponentEvents = (): IComponentEvents => ({\n  onUpdate: (component: IComponent, entity: IEntity) => null,\n  onChange: (eventName: string, component: IComponent, entity: IEntity) => null,\n})\n\nexport function partialSetValue(object: any) {\n  return (path: (string | number)[], value: any) => setValue(object, path, value);\n}\n\nexport function setValue(object: any, path: (string | number)[], value: any) {\n  let a = path;\n  let o = object;\n\n  for (let i = 0; i < a.length - 1; i++) {\n      let n = a[i];\n      if (n in o) {\n          o = o[n];\n      } else {\n          o[n] = {};\n          o = o[n];\n      }\n  }\n\n  o[a[a.length - 1]] = value;\n}\n\nexport function getValue<T extends any>(object: T, path: string) {\n  let o = object;\n  path = path.replace(/\\[(\\w+)\\]/g, '.$1');\n  path = path.replace(/^\\./, '');\n  let a = path.split('.');\n\n  while (a.length) {\n      let n = a.shift() as string;\n\n      if (n in o) {\n          o = o[n];\n      } else {\n          return;\n      }\n  }\n\n  return o;\n}\n\nexport function keys<O>(o: O) {\n  return Object.keys(o) as (keyof O)[];\n}\n\nexport function once(fn: AnonymousCB) {\n  let called = false;\n  return (...args: any[]) => {\n    if (!called) {\n      called = true;\n      return fn(...args);\n    }\n    return undefined;\n  }\n}\n\nexport const clamp = (min: number, max: number, num: number) => {\n  return num < min ? min : num > max ? max : num;\n}\n\nexport const ifStateProp = (obj: any) => {\n  return obj && obj.state !== undefined;\n}\nexport function boxMullerRandomGeneratorFactory() {\n  let phase:      number = 0;\n  let random:     () => number;\n  let x1:         number;\n  let x2:         number;\n  let w:          number;\n  let z:          number;\n\n  random = Math.random;\n\n  return function () {\n      if (!phase) {\n          do {\n              x1 = 2.0 * random() - 1.0;\n              x2 = 2.0 * random() - 1.0;\n              w = x1 * x1 + x2 * x2;\n          } while (w >= 1.0);\n\n          w = Math.sqrt((-2.0 * Math.log(w)) / w);\n          z = x1 * w;\n      } else {\n          z = x2 * w;\n      }\n\n      phase ^= 1;\n\n      return z;\n  }\n};\n\n/**\n * limits your function to be called at most every W milliseconds, where W is wait.\n * Calls over W get dropped.\n * Thanks to Pat Migliaccio.\n * see https://medium.com/@pat_migliaccio/rate-limiting-throttling-consecutive-function-calls-with-queues-4c9de7106acc\n * @param fn\n * @param wait\n * @example let throttledFunc = throttle(myFunc,500);\n */\nexport function throttle<T>(fn: Function, wait: number){\n  let isCalled = false;\n  let last: T;\n  return function(...args: any[]): T {\n    if (!isCalled){\n      last = fn(...args);\n      isCalled = true;\n      setTimeout(function(){\n        isCalled = false;\n      }, wait)\n    }\n    return last;\n  };\n}\n\nexport const defaultBoundary = {\n  top:    0,\n  left:   0,\n  bottom: 600,\n  right:  800,\n}\n\nexport enum KeysEnum {\n  Backspace = 8,\n  Tab = 9,\n  Enter = 13,\n  Shift = 16,\n  Ctrl = 17,\n  Alt = 18,\n  PauseBreak = 19,\n  CapsLock = 20,\n  Escape = 27,\n  Space = 32,\n  PageUp = 33,\n  PageDown = 34,\n  End = 35,\n  Home = 36,\n\n  LeftArrow = 37,\n  UpArrow = 38,\n  RightArrow = 39,\n  DownArrow = 40,\n\n  Insert = 45,\n  Delete = 46,\n\n  Zero = 48,\n  ClosedParen = Zero,\n  One = 49,\n  ExclamationMark = One,\n  Two = 50,\n  AtSign = Two,\n  Three = 51,\n  PoundSign = Three,\n  Hash = PoundSign,\n  Four = 52,\n  DollarSign = Four,\n  Five = 53,\n  PercentSign = Five,\n  Six = 54,\n  Caret = Six,\n  Hat = Caret,\n  Seven = 55,\n  Ampersand = Seven,\n  Eight = 56,\n  Star = Eight,\n  Asterik = Star,\n  Nine = 57,\n  OpenParen = Nine,\n\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n\n  LeftWindowKey = 91,\n  RightWindowKey = 92,\n  SelectKey = 93,\n\n  Numpad0 = 96,\n  Numpad1 = 97,\n  Numpad2 = 98,\n  Numpad3 = 99,\n  Numpad4 = 100,\n  Numpad5 = 101,\n  Numpad6 = 102,\n  Numpad7 = 103,\n  Numpad8 = 104,\n  Numpad9 = 105,\n\n  Multiply = 106,\n  Add = 107,\n  Subtract = 109,\n  DecimalPoint = 110,\n  Divide = 111,\n\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n\n  NumLock = 144,\n  ScrollLock = 145,\n\n  SemiColon = 186,\n  Equals = 187,\n  Comma = 188,\n  Dash = 189,\n  Period = 190,\n  UnderScore = Dash,\n  PlusSign = Equals,\n  ForwardSlash = 191,\n  Tilde = 192,\n  GraveAccent = Tilde,\n\n  OpenBracket = 219,\n  ClosedBracket = 221,\n  Quote = 222\n}\n  ","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory } from \"../utils\";\n\nexport type WithName = { name: string };\n\nexport function nameableFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithName, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithName>>({\n        id,\n        name: 'name',\n        entityId: entity.id,\n        state: { name: state.name },\n        update: () => null,\n      }))\n  }\n}\n","export const ON_START_GAME      = 'game:start';\nexport const ON_GAME_WIN        = 'game:win';\nexport const ON_GAME_OVER       = 'game:lose';\n\nexport const ON_LEVEL_LOAD      = 'level:load';\nexport const ON_LEVEL_BEGIN     = 'level:begin';\nexport const ON_LEVEL_COMPLETE  = 'level:finished';\n\nexport const ON_ATTACK          = 'attack:*';\nexport const ON_PLAYER_ATTACK   = 'attack:player';\nexport const ON_ENEMY_ATTACK    = 'attack:enemy';\n\nexport const ON_COLLISION       = 'collision:begin';\n\nexport const ON_REVIVE          = 'revive:*';\nexport const ON_REVIVE_PLAYER   = 'revive:player';\n\nexport const ON_DEATH           = 'dead';\nexport const ON_ENEMY_DEATH     = 'dead:enemy';\nexport const ON_PLAYER_DEATH    = 'dead:player';\n\nexport const ON_ENEMY_FREE      = 'enemy:free';\nexport const ON_ENEMY_GROUP     = 'enemy:group';\nexport const ON_ENEMY_PATH      = 'enemy:path';\n\nexport const ON_START_ENGINE    = 'engine:start';\nexport const ON_STOP_ENGINE     = 'engine:stop';\n\n// !!! Move to the catalogue I think\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter } from \"../utils\";\nimport { ON_DEATH, ON_REVIVE_PLAYER } from \"../../events\";\n\nconst COMPONENT_NAMESPACE = 'health';\n\nexport interface WithHealth {\n  health: {\n    value: number;\n    immortal?: boolean;\n  };\n};\n\nexport type WithHealthState = WithHealth & { isDead?: boolean; };\n\nexport function killableFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithHealthState, events: IComponentEvents, id: number = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithHealthState>>({\n        id,\n        name: COMPONENT_NAMESPACE,\n        entityId: entity.id,\n        state: { health: state.health, isDead: state.isDead },\n        update: (system: ISystemManager, component: IComponent<WithHealthState>) => {\n\n          if (component.state.health.immortal) {\n            return;\n          }\n\n          const wasDeadBefore = component.state.isDead;\n          const isDeadNow = !(component.state.health.value > 0);\n\n          component.state.isDead = isDeadNow;\n\n          if (!wasDeadBefore && isDeadNow) {\n            // sad times\n            events.onChange!(ON_DEATH, component, entity)\n          }\n        },\n      }))\n  }\n}\n\nexport type IKillableEntity = IComponent<WithHealthState>\n\nexport const selectKillableState = createSelector<WithHealthState>(COMPONENT_NAMESPACE);\nexport const setKillableState    = createSetter<WithHealthState>(selectKillableState);\n","import { IComponent, ISystemManager, IEntity, IComponentEvents, IVector } from \"../types\";\nimport { factory } from \"../utils\";\n\nconst COMPONENT_NAMESPACE = 'geometry';\n\nexport type IGeometry  = { width: number; height: number; };\nexport type WithGeometry = { geometry: IGeometry };\n\nexport function withGeometryFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithGeometry, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithGeometry>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { geometry: { width: state.geometry.width, height: state.geometry.height } },\n        update: (system: ISystemManager, component: IWithGeometryEntity) => null,\n      }))\n  }\n}\n\nexport type IWithGeometryEntity = IComponent<WithGeometry>\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { WithPosition } from \"./withPosition\";\nimport { factory, boxMullerRandomGeneratorFactory, clamp, throttle } from \"../utils\";\n\nexport type WithRandomWalkArgs = { controls?: Partial<WithRandomWalk> };\nexport type WithRandomWalk = { direction: IVector; moving: boolean; speed: IVector; disabled: boolean; jitter: number; };\n\n// const defaults = { direction: { x: 0, y: 0 }, moving: true, speed: { x: 2, y: 1.65 }, disabled: false, jitter: 400 }\nconst defaults = { direction: { x: 0, y: 0 }, moving: true, speed: { x: 0, y: 2.65 }, disabled: false, jitter: 400 }\n\nexport function withRandomWalkFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithRandomWalkArgs, events: IComponentEvents, id = -1) => {\n\n    const options = state.controls || defaults;\n\n    let jitter: number = options.jitter || defaults.jitter;\n    let randomWalkGeneratorX: () => number;\n    let randomWalkGeneratorY: () => number;\n\n    const setJitter = (level?: number) => {\n      jitter = level || defaults.jitter;\n      randomWalkGeneratorX = throttle<number>(boxMullerRandomGeneratorFactory(), jitter);\n      randomWalkGeneratorY = throttle<number>(boxMullerRandomGeneratorFactory(), jitter);\n    }\n\n    setJitter(jitter);\n\n    return system.registerComponent(\n      factory<IComponent<WithRandomWalk>>({\n        id,\n        entityId: entity.id,\n        name: 'controls',\n        state: {\n          direction: options.direction || { x: 0, y: 0 },\n          moving: options.moving || true,\n          speed: options.speed || { x: 2, y: 1.65 },\n          disabled: options.disabled || false,\n          jitter,\n        },\n        update: (system: ISystemManager, component: IWithRandomWalkEntity) => {\n\n          if (component.state.jitter !== jitter) {\n            setJitter(jitter);\n          }\n\n          if (!component.state.disabled) {\n            handleMovement(entity, component, system, events, randomWalkGeneratorX, randomWalkGeneratorY);\n          }\n        },\n      }))\n  }\n}\n\ntype IWithRandomWalkEntity = IComponent<WithRandomWalk & Partial<WithPosition>>;\ntype RNGFunc = (...args: any[]) => number;\n\nfunction handleMovement(entity: IEntity, component: IWithRandomWalkEntity, system: ISystemManager, events: IComponentEvents, randomWalkGeneratorX: RNGFunc, randomWalkGeneratorY: RNGFunc) {\n\n  if (component.state.disabled) {\n    return;\n  }\n\n  const deltaX = randomWalkGeneratorX();\n  const deltaY = randomWalkGeneratorY();\n\n  component.state.direction.x = clamp(-1, 1, deltaX);\n\n  component.state.direction.y = clamp(-1, 1, deltaY);\n\n  const {x, y} = component.state.direction;\n\n  if (x === 0 && y === 0) {\n    component.state.moving = false;\n  } else {\n    component.state.moving = true;\n  }\n}\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter } from \"../utils\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithPosition } from \"./withPosition\";\n\nconst COMPONENT_NAMESPACE = 'collidable';\n\nexport type IsCollidable = { collidable?: boolean; collisionGroup: string; };\n\nexport function isCollidableFactory(system: ISystemManager) {\n  return (entity: IEntity, state: IsCollidable, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<IsCollidable>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { collidable: state.collidable || true, collisionGroup: state.collisionGroup },\n        update: (system: ISystemManager, component: ICollidableEntity) => null,\n      }))\n  }\n}\n\ntype ICollidableEntity = IComponent<IsCollidable & WithGeometry & WithPosition>;\n\nexport const selectCollidableState = createSelector<ICollidableEntity>(COMPONENT_NAMESPACE);\nexport const setCollidableState    = createSetter<ICollidableEntity>(selectCollidableState);\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter } from \"../utils\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithPosition } from \"./withPosition\";\n\nconst COMPONENT_NAMESPACE = 'loot';\n\nexport type IsLootable<T extends any = {}> = { loot?: T; };\n\nexport function lootableFactory<T>(system: ISystemManager) {\n  return (entity: IEntity, state: IsLootable<T>, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<IsLootable<T>>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { loot: state.loot },\n        update: (system: ISystemManager, component: LootableEntity) => null,\n      }))\n  }\n}\n\nexport type LootableEntity<T extends any = {}> = IComponent<IsLootable<T> & WithGeometry & WithPosition>\n\nexport const selectLootableState = createSelector<LootableEntity>(COMPONENT_NAMESPACE);\nexport const setLootableState    = createSetter<LootableEntity>(selectLootableState);\n","import { IComponent, ISystemManager, IEntity, EntityIdType, Bounds, IVector, IDimensions, IComponentEvents, BoundedTouchingState, BoundedTouchingStateKeys } from \"../types\";\nimport { factory, createSelector, createSetter, keys, defaultBoundary, ifStateProp, clamp } from \"../utils\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithPosition } from \"./withPosition\";\n\nconst COMPONENT_NAMESPACE = 'boundary';\n\nexport type WithBoundary = { boundary: Bounds; };\n\nexport function withBoundaryFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithBoundary, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithBoundary>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { boundary: state.boundary || defaultBoundary },\n        update: (system: ISystemManager, component: IBoundedEntity) => {\n          const geometryComponent = system.getEntityComponent<WithGeometry>(entity, 'geometry');\n          const positionComponent = system.getEntityComponent<WithPosition>(entity, 'position');\n          \n          if (ifStateProp(geometryComponent)) {\n\n            const {width, height} = geometryComponent.state.geometry;\n            const {boundary}      = component.state;\n            \n            const clampedX = clamp(boundary.left, boundary.right - width,   positionComponent.state.position.x)\n            const clampedY = clamp(boundary.top,  boundary.bottom - height, positionComponent.state.position.y)\n\n            positionComponent.state.position.x = clampedX;\n            positionComponent.state.position.y = clampedY;\n          }\n        },\n      }))\n  }\n}\n\ntype IBoundedEntity = IComponent<WithGeometry & WithPosition & WithBoundary>\n\nexport const selectBoundaryState = createSelector<IBoundedEntity>(COMPONENT_NAMESPACE);\nexport const setBoundaryState    = createSetter<IBoundedEntity>(selectBoundaryState);\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory } from \"../utils\";\n\nconst COMPONENT_NAMESPACE = 'texture';\n\nexport type WithTexture = { texture: string | number; };\n\nexport function withTextureFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithTexture, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithTexture>>({\n        id,\n        entityId: entity.id,\n        name:     COMPONENT_NAMESPACE,\n        state:    { texture: state.texture },\n        update:   (system: ISystemManager, component: IWithTextureEntity) => null,\n      }))\n  }\n}\n\nexport type IWithTextureEntity = IComponent<WithTexture>\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\n\nimport { factory, ifStateProp } from \"../utils\";\nimport { WithPosition } from \"./withPosition\";\n\ntype WiggleState = { counter: number; increment: number; };\n\nexport type WithBugWiggleArgs = { wiggling: boolean; wiggleState?: WiggleState; };\nexport type WithBugWiggle = { wiggling: boolean; wiggleState: WiggleState; };\n\nconst BRAKE       = 0.1;\nconst PULSE_WIDTH = 4;\n\nexport function withBugWiggleFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithBugWiggleArgs, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithBugWiggle>>({\n        id,\n        entityId: entity.id,\n        name: 'wiggle',\n        state: {\n          wiggling: state.wiggling,\n\n          wiggleState: {\n            counter: 0,\n            increment: +1,\n          }\n        },\n        update: (system: ISystemManager, component: IWithBugWiggleEntity) => {\n          handleBugWiggle(entity, component, system, events);\n        },\n      }))\n  }\n}\n\ntype IWithBugWiggleEntity = IComponent<WithBugWiggle & Partial<WithPosition>>;\n\nfunction handleBugWiggle(entity: IEntity, component: IWithBugWiggleEntity, system: ISystemManager, events: IComponentEvents) {\n\n  if (!component.state.wiggling) {\n    return;\n  }\n\n  let {counter, increment} = component.state.wiggleState;\n\n  if(counter == PULSE_WIDTH) {\n    component.state.wiggleState.increment = -1;\n  };\n\n  if(counter == -PULSE_WIDTH) {\n    component.state.wiggleState.increment = +1;\n  };\n\n  component.state.wiggleState.counter+= increment;\n\n  const positionComponent = system.getEntityComponent<WithPosition>(entity, 'position');\n\n  if (ifStateProp(positionComponent)) {\n    positionComponent.state.position.x += (counter * BRAKE);\n  }\n}\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter, clamp, ifStateProp } from \"../utils\";\nimport { WithBoundary } from \"./withBoundary\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithControls } from \"./withControls__unused\";\n\nconst COMPONENT_NAMESPACE = 'position';\n\nexport type WithPosition = { position: IVector; controllable?: boolean; }\nexport type WithCenter = { center: IVector; }\nexport type WithPositionState = WithPosition & WithCenter;\n\nexport function withPositionFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithPosition, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithPositionState>>({\n        id,\n        name: COMPONENT_NAMESPACE,\n        entityId: entity.id,\n        state: { position: { ...state.position }, center: { ...state.position }, controllable: state.controllable || true },\n        update: (system: ISystemManager, component: IComponent<WithPositionState>) => {\n          handleMovementState(entity, system, component, events);\n        },\n      }))\n    }\n  }\n  \nfunction handleMovementState(entity: IEntity, system: ISystemManager, component: IComponent<WithPositionState>, events: IComponentEvents) {\n\n  if (!component.state.controllable) {\n    return;\n  }\n\n  const controls = system.getEntityComponent<WithControls>(entity, 'controls');\n\n  if (!component.state.controllable || !controls || !controls.state.moving) {\n    return;\n  }\n\n  // ai yai yai, wtf is this doing here\n  const {direction, speed} = controls.state;\n\n  component.state.position.x += direction.x * speed.x;\n  component.state.position.y += direction.y * speed.y;\n  // !! ??? ^^^^^^^^\n\n  const geometryComponent = system.getEntityComponent<WithGeometry>(entity, 'geometry');\n\n  if (geometryComponent) {\n    const {width, height} = geometryComponent.state.geometry;\n\n    component.state.center.x = component.state.position.x - width / 2;\n    component.state.center.y = component.state.position.y - height / 2;\n  }\n};\n\nexport const selectPositionState = createSelector<WithPosition>(COMPONENT_NAMESPACE);\nexport const setPositionState    = createSetter<WithPosition>(selectPositionState);\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { factory } from \"../utils\";\nimport { WithPositionState } from \"./withPosition\";\n\nconst COMPONENT_NAMESPACE = 'homePosition';\n\nexport type WithHomePosition = { homePosition: IVector; goHome?: boolean; isHome?: boolean; }\n\nexport function withHomePositionFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithHomePosition, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithHomePosition>>({\n        id,\n        name: COMPONENT_NAMESPACE,\n        entityId: entity.id,\n        state: { homePosition: { ...state.homePosition }, goHome: state.goHome },\n        update: (system: ISystemManager, component: IComponent<WithHomePosition & WithPositionState>) => {\n          handleMovementState(entity, system, component, events);\n        },\n      })\n    )\n  }\n}\n\nconst BOOGETY = 66;\nconst TIME_TO_GET_HOME = BOOGETY * 1.1; // htfu\n\nfunction handleMovementState(entity: IEntity, system: ISystemManager, component: IComponent<WithHomePosition & WithPositionState>, events: IComponentEvents) {\n\n  const moveable = system.getEntityComponent<WithPositionState>(entity, 'position');\n\n  if (!moveable || !moveable.state) {\n    return;\n  }\n\n  const { homePosition: { x, y } } = component.state;\n\n  const distX = (x - moveable.state.position.x);\n  const distY = (y - moveable.state.position.y);\n  \n  if (component.state.goHome) {\n    moveable.state.position.x = (Math.abs(distX) < 1) ? x : moveable.state.position.x + (distX / TIME_TO_GET_HOME);\n    moveable.state.position.y = (Math.abs(distY) < 1) ? y : moveable.state.position.y + (distY / TIME_TO_GET_HOME);\n  }\n\n  if (distX === 0 && distY === 0) {\n    component.state.isHome = true;\n  } else {\n    component.state.isHome = false;\n  }\n};\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory, ifStateProp } from \"../utils\";\nimport { WithBoundary } from \"./withBoundary\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithPositionState } from \"./withPosition\";\n\nconst COMPONENT_NAMESPACE = 'worldwrap';\n\nexport function withWrapAroundPositionFactory(system: ISystemManager) {\n  return (entity: IEntity, state: {}, events: IComponentEvents, id = -1) => {\n    return system.registerComponent<WithPositionState>(\n      factory<IComponent>({\n        id,\n        name: COMPONENT_NAMESPACE,\n        entityId: entity.id,\n        state: {},\n        update: (system: ISystemManager, component: IComponent<{}>) => {\n          handleMovementState(entity, system, component, events);\n        },\n      }))\n    }\n  }\n  \nfunction handleMovementState(entity: IEntity, system: ISystemManager, component: IComponent<{}>, events: IComponentEvents) {\n\n  const positionComponent = system.getEntityComponent<WithPositionState>(entity, 'position');\n\n  // wrap around if necessary\n  const boundaryComponent = system.getEntityComponent<WithBoundary>(entity, 'boundary');\n  const geometryComponent = system.getEntityComponent<WithGeometry>(entity, 'geometry');\n  \n  if (ifStateProp(boundaryComponent) && ifStateProp(geometryComponent)) {\n\n    const {width, height} = geometryComponent.state.geometry;\n    const {boundary}      = boundaryComponent.state;\n\n    const {x, y} = positionComponent.state.position;\n    positionComponent.state.position.x = (x < boundary.left) ? (boundary.right - width) : (x > boundary.right) ? boundary.left : x;\n    positionComponent.state.position.y = (y < boundary.top) ? (boundary.bottom - height) : (y > boundary.bottom) ? boundary.top : y;\n  }\n};\n","import { ISystemManager, IVector, IDimensions } from \"../../engine/types\";\nimport { createMob } from \"../Domain/mob\";\nimport { defaultBoundary } from \"../../engine/utils\";\n\n// const defaultPosition = {\n//   x: -999,\n//   y: -999,\n// }\n\nexport function createEnemy(\n    system:           ISystemManager,\n    textureId:        number,\n    name:             string,\n    position:         IVector,\n    homePosition?:    IVector,\n    geometry?:        IDimensions,\n    collisionGroup:   string = 'hostile',\n) {\n\n  const entity = createMob(system, {\n    name,\n\n    texture: textureId,\n\n    wiggling: true,\n\n    controls: {\n      disabled: true,\n    },\n\n    health: {\n      value: 1,\n    },\n\n    position: position,\n\n    homePosition: homePosition || position,\n\n    geometry: geometry ||{\n      width:  64,\n      height: 64,\n    },\n\n    loot: {\n      points: 10,\n    },\n\n    boundary: defaultBoundary,\n\n    collisionGroup,\n  });\n\n  return entity;\n}\n","import { IEntity, ISystemManager } from \"../../engine/types\";\nimport { IPointsLoot } from \"../types\";\n\nimport { nameableFactory,               WithName } from \"../../engine/components/nameable\";\nimport { killableFactory,               WithHealthState } from \"../../engine/components/killable\";\nimport { withGeometryFactory,           WithGeometry } from \"../../engine/components/withGeometry\";\nimport { withRandomWalkFactory,         WithRandomWalkArgs } from \"../../engine/components/withRandomWalk\";\nimport { isCollidableFactory,           IsCollidable } from \"../../engine/components/isCollidable\";\nimport { lootableFactory,               IsLootable } from \"../../engine/components/lootable\";\nimport { withBoundaryFactory,           WithBoundary } from \"../../engine/components/withBoundary\";\nimport { withTextureFactory,            WithTexture } from \"../../engine/components/withTexture\";\nimport { withBugWiggleFactory,          WithBugWiggle, WithBugWiggleArgs } from \"../../engine/components/withBugWiggle\";\nimport { WithPositionState,             withPositionFactory, WithPosition } from \"../../engine/components/withPosition\";\nimport { withHomePositionFactory,       WithHomePosition } from \"../../engine/components/withHomePosition\";\nimport { withWrapAroundPositionFactory } from \"../../engine/components/withWrapAroundPosition\";\n\n\nexport function createMob(\n  system:   ISystemManager,\n  options:  MobModelArgs,\n): IEntity {\n  const withName          = nameableFactory(system);\n  const withHealth        = killableFactory(system);\n  const withGeometry      = withGeometryFactory(system);\n  const withBoundary      = withBoundaryFactory(system);\n  const withBugWiggle     = withBugWiggleFactory(system);\n  const withRandomWalk    = withRandomWalkFactory(system);\n  const withPosition      = withPositionFactory(system);\n  const withWorldWrap     = withWrapAroundPositionFactory(system);\n  const withHomePosition  = withHomePositionFactory(system);\n  const isCollidable      = isCollidableFactory(system);\n  const withTexture       = withTextureFactory(system);\n  const isLootable        = lootableFactory<IPointsLoot>(system);\n\n  const entity = system.registerEntity();\n\n  system.registerComponent(\n    withName(entity, options, system.events)\n  );\n  system.registerComponent(\n    withHealth(entity, options, system.events)\n  );\n  system.registerComponent(\n    withBoundary(entity, options, system.events)\n  );\n  system.registerComponent(\n    withBugWiggle(entity, options, system.events)\n  );\n  system.registerComponent(\n    withPosition(entity, options, system.events)\n  );\n  system.registerComponent(\n    withRandomWalk(entity, options, system.events)\n  );\n  system.registerComponent(\n    withWorldWrap(entity, options, system.events)\n  );\n  system.registerComponent(\n    withHomePosition(entity, options, system.events)\n  );\n  system.registerComponent(\n    withGeometry(entity, options, system.events)\n  );\n  system.registerComponent(\n    withTexture(entity, options, system.events)\n  );\n  system.registerComponent(\n    isCollidable(entity, options, system.events)\n  );\n  system.registerComponent(\n    isLootable(entity, options, system.events)\n  );\n  return entity;\n}\n\nexport type MobModelArgs =\n  WithName                &\n  WithHealthState         &\n  WithPosition            &\n  WithGeometry            &\n  WithTexture             &\n  WithBoundary            &\n  WithRandomWalkArgs      &\n  WithBugWiggleArgs       &\n  WithHomePosition        &\n  IsLootable<IPointsLoot> &\n  IsCollidable;\n\nexport type MobModel =\n  WithName                &\n  WithHealthState         &\n  WithPositionState       &\n  WithGeometry            &\n  WithTexture             &\n  WithBoundary            &\n  WithRandomWalkArgs      &\n  WithBugWiggle           &\n  WithHomePosition        &\n  IsLootable<IPointsLoot> &\n  IsCollidable;\n","import MenuMusic from '../audio/Music/game-menu.mp3'\nimport MainMusic from '../audio/Music/game-main.mp3'\nimport EndMusic from '../audio/Music/game-end.mp3'\nimport SummaryMusic from '../audio/Music/game-main-summary.mp3'\n\nimport GameOverSound from '../audio/General Sounds/Fanfares/sfx_sounds_fanfare1.wav'\nimport YouWinSound from '../audio/General Sounds/Positive Sounds/sfx_sounds_powerup3.wav'\nimport LevelWinSound from '../audio/General Sounds/Fanfares/sfx_sounds_fanfare3.wav'\nimport NextLevelSound from '../audio/General Sounds/Positive Sounds/sfx_sounds_powerup2.wav'\nimport NewGameSound from '../audio/General Sounds/Interactions/sfx_sounds_interaction1.wav'\nimport PauseGameSound from '../audio/General Sounds/Pause Sounds/sfx_sounds_pause1_in.wav'\nimport UnPauseGameSound from '../audio/General Sounds/Pause Sounds/sfx_sounds_pause1_out.wav'\nimport { Omit } from 'react-router';\n\n\nexport const mkAudioSrc = (src: string, opts?: Omit<IHowlProperties, 'src'>) => ({ src: [src], ...opts });\n\nexport enum SpriteTextureIds {\n  Player          = 0,\n  Bug             = 1,\n  CrabBug         = 2,\n  HelmetBug       = 3,\n  PincerBug       = 4,\n  SonicBug        = 5,\n}\n\nexport const Sfx = {\n  NEW_GAME:     'newgame',\n  GAMEOVER:     'gameover',\n  YOU_WIN:      'youwin',\n  LEVEL_WIN:    'levelwin',\n  PAUSE:        'pause',\n  UNPAUSE:      'unpause',\n  NEXT_LEVEL:   'nextlevel',\n}\n\nexport const Songs = {\n  MENU:     'game-menu',\n  GAME:     'game-main',\n  END:      'game-end',\n  SUMMARY:  'game-main-summary',\n}\n\nexport const SongLibrary = {\n  [Songs.MENU]:     mkAudioSrc(MenuMusic,     { volume: 0.8 }),\n  [Songs.GAME]:     mkAudioSrc(MainMusic,     { volume: 0.4 }),\n  [Songs.END]:      mkAudioSrc(EndMusic,      { volume: 0.8 }),\n  [Songs.SUMMARY]:  mkAudioSrc(SummaryMusic,  { volume: 0.8 }),\n}\n\nexport const SfxLibrary = {\n  [Sfx.GAMEOVER]:    mkAudioSrc(GameOverSound),\n  [Sfx.LEVEL_WIN]:   mkAudioSrc(LevelWinSound),\n  [Sfx.NEXT_LEVEL]:  mkAudioSrc(NextLevelSound),\n  [Sfx.YOU_WIN]:     mkAudioSrc(YouWinSound),\n  [Sfx.NEW_GAME]:    mkAudioSrc(NewGameSound),\n  [Sfx.PAUSE]:       mkAudioSrc(PauseGameSound),\n  [Sfx.UNPAUSE]:     mkAudioSrc(UnPauseGameSound),\n}\n","import { IEntity, WithComponentMeta, ISystemManager } from \"../../engine/types\";\nimport * as React from 'react';\nimport { MobModel } from \"../../game/Domain/mob\";\nimport { CharacterModel } from \"../../game/Domain/character\";\n\ninterface WithEntityProps {\n  entity:     IEntity;\n  system:     ISystemManager;\n  onDeath?:   (entity: IEntity) => void;\n}\n\nexport type IModelType<P> = { model: WithComponentMeta<P>; system: ISystemManager };\n\nexport const withEntity = <P extends MobModel | CharacterModel> (\n    Component: React.ComponentType<IModelType<P>>,\n): React.ComponentType<WithEntityProps> => {\n  function WithEntity(props: WithEntityProps) {\n    const { entity, system, ...rest } = props;\n    const model = system.getEntityModel<P>(props.entity);\n    return <Component {...rest} model={model} system={system} />;\n  };\n\n  return WithEntity;\n}\n","import {useState} from 'react';\n\ninterface IFrame {\n  frame:      string;\n  duration:   number;\n}\n\ninterface IAnimations {\n  normal: IFrame[];\n  death:  IFrame[];\n}\n\nexport interface WithAnimationOptions {\n  animations:       IAnimations;\n  currentState:     keyof IAnimations;\n  onFinished:       (...args: any[]) => void;\n  currentFrame?:    string;\n}\n\nexport const withAnimationState = (options: WithAnimationOptions) => {\n  const [animations, setAnimations] = useState(options.animations);\n  const [currentFrame, setCurrentFrame] = useState(options.currentFrame || getDefaultFrame(options));\n  const [currentState, setCurrentState] = useState(options.currentState);\n  const [lastState, setLastState] = useState(\"\" as 'normal' | 'death');\n  const [timers, setTimers] = useState<NodeJS.Timer[]>([])\n\n  function queueFrame(frame: string, when: number) {\n    const setFrame = (fr: string) => setCurrentFrame(fr);\n\n    timers.push(setTimeout(() => setFrame(frame), when));\n  }\n\n  if (different(lastState, currentState)) {\n    let buffer: number = 0;\n\n    setLastState(currentState);\n\n    animations[currentState]\n      .forEach(({ frame, duration }) => {\n        queueFrame(frame, buffer);\n        buffer += duration;\n      }\n    )\n    \n    const timer = setTimeout(() => {\n      options.onFinished(currentState)\n    }, buffer);\n\n    setTimers(timers.concat(timer));\n  }\n\n  return { currentFrame, setCurrentState };\n}\n\nexport function different<T>(a: T, b: T) {\n  return a !== b;\n}\n\nexport const fr = (frame: string, duration: number) => ({ frame, duration });\n\nexport function getDefaultFrame(options: WithAnimationOptions): string {\n  return options.animations[options.currentState][0].frame;\n}\n","import { ISystemManager, IAudioCollectionInitializer, WithComponentMeta, IComponent, IEntity, EntityIdType } from '../../engine/types';\nimport {useEffect} from 'react';\n\nimport { ON_DEATH, ON_ATTACK } from '../../events';\nimport { keys } from '../../engine/utils';\nimport { WithHealthState } from '../../engine/components/killable';\n\n\nexport const withSoundEffects = <T>(options: WithSoundEffectsOptions<T>) => {\n\n  const playDeathAudio = (component: IComponent<WithHealthState>, entity: IEntity): void => {\n    const collectionKey = mkAudioCollectionKey(entity.id, 'death');\n    options.system.audio.playSound(collectionKey);\n  }\n\n  const playAttackAudio = (entity: IEntity): void => {\n    const collectionKey = mkAudioCollectionKey(entity.id, 'shoot');\n    options.system.audio.playSound(collectionKey);\n  }\n\n  useEffect(() => {\n    options.system.events.registerListener(ON_DEATH,         playDeathAudio);\n    options.system.events.registerListener(ON_ATTACK,        playAttackAudio);\n\n    keys(options.sounds).map(key => {\n      const collectionKey = mkAudioCollectionKey(options.entity.id, `${key}`);\n\n      options.system.audio.registerSound(collectionKey, {\n        src: [options.sounds[key]],\n        volume: 0.2,\n      })\n    })\n\n    return function cleanup() {\n      options.system.events.unRegisterListener(ON_DEATH,     playDeathAudio);\n      options.system.events.unRegisterListener(ON_ATTACK,    playAttackAudio);\n  \n      keys(options.sounds).map((actionType: string | number) => {\n        const collectionKey = mkAudioCollectionKey(options.entity.id, `${actionType}`);\n\n        options.system.audio.unRegisterSound(collectionKey);\n      })\n    }\n  }, []);\n};\n\nexport type WithSoundEffectsOptions<T> = {\n  entity:         WithComponentMeta<T>\n  system:         ISystemManager;\n  sounds:         IAudioCollectionInitializer;\n}\n\nexport function mkAudioCollectionKey(entityId: EntityIdType, action: string) {\n  return `entity-${entityId}:${action}`;\n}\n","import { ISystemManager, IComponent, IEntity } from '../../engine/types';\nimport {useEffect, useState} from 'react';\nimport { ON_ENEMY_DEATH, ON_PLAYER_DEATH, ON_REVIVE_PLAYER } from '../../events';\nimport { WithCollisions } from '../../engine/components/withCollisions';\n\nexport const withDeathState = (options: WithDeathEffectOwnProps) => {\n  const [dead, setDead] = useState(options.dead);\n\n  const handleDeathEvent = (component: IComponent<WithCollisions>) => {\n    if (!dead) {\n\n      if (options.deathEvent === ON_PLAYER_DEATH) {\n        setDead(true);\n      }\n\n      if (options.deathEvent === ON_ENEMY_DEATH) {\n\n        const { collisions } = component.state;\n\n        if (collisions.indexOf(options.entity.id) !== -1) {\n          setDead(true);\n        }\n      }\n    }\n  }\n\n  const handleRevivePlayerEvent = (component: IComponent<WithCollisions>) => {\n    setDead(false);\n  }\n\n  useEffect(() => {\n\n    options.system.events.registerListener(ON_REVIVE_PLAYER, handleRevivePlayerEvent);\n    options.system.events.registerListener(options.deathEvent, handleDeathEvent);\n    \n    return function cleanup() {\n      options.system.events.unRegisterListener(ON_REVIVE_PLAYER, handleRevivePlayerEvent);\n      options.system.events.unRegisterListener(options.deathEvent, handleDeathEvent);\n    }\n  }, []);\n\n  return { dead };\n}\n\nexport type WithDeathEffectOwnProps = {\n  entity:         IEntity;\n  system:         ISystemManager;\n} & WithDeathEffectOptions;\n\nexport type WithDeathEffectOptions = {\n  deathEvent:     typeof ON_ENEMY_DEATH | typeof ON_PLAYER_DEATH;\n  dead?:          boolean;\n}\n","import { IModelType } from './withEntity';\nimport * as React from 'react';\nimport { Omit } from 'react-router';\n\nimport { CharacterModel } from '../../game/Domain/character';\nimport { MobModel } from '../../game/Domain/mob';\n\nimport { withAnimationState, WithAnimationOptions } from '../hooks/withAnimationState';\nimport { withSoundEffects } from '../hooks/withSoundEffects';\nimport { IAudioCollectionInitializer, WithComponentMeta, IComponent, IEntity } from '../../engine/types';\nimport { withDeathState, WithDeathEffectOptions } from '../hooks/withDeathState';\nimport { WithCollisions } from '../../engine/components/withCollisions';\nimport { once } from '../../engine/utils';\n\n\ninterface WithSpriteEffectsOptions extends WithAnimationOptions, WithDeathEffectOptions {\n  elementId:          string;\n  sounds:             IAudioCollectionInitializer;\n  handleCollision?:   (model: WithComponentMeta<any>, component: IComponent<WithCollisions>, entity: IEntity) => void;\n}\n\ntype HOCModelType = MobModel | CharacterModel;\n\ntype ISpriteState = 'normal' | 'death';\n\nexport function withSpriteEffects<T extends HOCModelType>(\n  options: Omit<WithSpriteEffectsOptions, 'onFinished'>\n): React.ComponentType<IModelType<T>> {\n  return function WithSpriteEffectsHOC(props: IModelType<T>) {\n    const [hidden, setHidden] = React.useState(() => false)\n    const [dead, setDead]     = React.useState(() => false)\n\n    const {currentFrame, setCurrentState} = withAnimationState({\n      animations:             options.animations,\n      currentState:           options.currentState,\n\n      onFinished:             (state: ISpriteState) =>\n        { if (state === 'death') setHidden(true); }\n    });\n\n    const deathState = withDeathState({\n      entity:         props.model,\n      system:         props.system,\n      deathEvent:     options.deathEvent,\n    })\n\n    withSoundEffects<T>({\n      entity:         props.model,\n      system:         props.system,\n      sounds:         options.sounds,\n    });\n\n    const setStateToAlive = () => {\n      setCurrentState('normal');\n      setDead(false);\n      setTimeout(() => {\n        setHidden(false);\n      }, 100)\n      setTimeout(() => {\n        setHidden(true);\n      }, 300)\n      setTimeout(() => {\n        setHidden(false);\n      }, 400)\n      setTimeout(() => {\n        setHidden(true);\n      }, 600)\n      setTimeout(() => {\n        setHidden(false);\n      }, 700)\n      setTimeout(() => {\n        setHidden(true);\n      }, 900)\n      setTimeout(() => {\n        setHidden(false);\n      }, 1100)\n      setTimeout(() => {\n        setHidden(true);\n      }, 1400)\n      setTimeout(() => {\n        setHidden(false);\n      }, 1500)\n    }\n\n    const setStateToDead = once(() => {\n      setCurrentState('death');\n      setDead(true);\n    })\n\n    if (deathState.dead && !dead) {\n      setStateToDead();\n    }\n\n    if (dead && !deathState.dead) {\n      setStateToAlive();\n    }\n\n    const styles: React.CSSProperties = {\n      position:               'absolute',\n      backgroundImage:        `url(${currentFrame})`,\n      backgroundSize:         'contain',\n      backgroundPosition:     'center',\n      width:                  '64px',\n      height:                 '64px',\n      left:                   hidden ? -9999 : props.model.position.x,\n      top:                    hidden ? -9999 : props.model.position.y,\n      display:                cssDisplayValue(hidden),\n    }\n  \n    return (\n      <div id={options.elementId} className=\"sprite\" style={styles} />\n    )\n  }\n}\n\nfunction cssDisplayValue(dead: boolean) {\n  return dead ? 'none' : ''\n}\n","import { CharacterModel } from '../../../game/Domain/character';\n\nimport { withEntity } from '../../Hoc/withEntity';\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Cannon/sfx_wpn_cannon1.wav';\nimport DeathSound from '../../../audio/Explosions/Long/sfx_exp_long1.wav';\nimport { ON_PLAYER_DEATH } from '../../../events';\n\nexport const AnimatedPlayer = withSpriteEffects<CharacterModel>({\n  elementId: 'player',\n\n  currentState: 'normal',\n\n  animations: {\n    normal: [\n      fr(require('../../../assets/player/ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/player/explosion-1/explosion-1-01.png'), 0),\n      fr(require('../../../assets/player/explosion-1/explosion-1-02.png'), 100),\n      fr(require('../../../assets/player/explosion-1/explosion-1-03.png'), 100),\n      fr(require('../../../assets/player/explosion-1/explosion-1-04.png'), 100),\n      fr(require('../../../assets/player/explosion-1/explosion-1-05.png'), 75),\n    ],\n  },\n\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n\n  deathEvent: ON_PLAYER_DEATH,\n});\n\nexport const ConnectedPlayer = withEntity<CharacterModel>(AnimatedPlayer)\n","import { MobModel } from '../../../game/Domain/mob';\n\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Lasers/sfx_wpn_laser1.wav';\nimport DeathSound from '../../../audio/Explosions/Short/sfx_exp_short_soft5.wav';\nimport { ON_ENEMY_DEATH } from '../../../events';\n\nexport const AnimatedBug = withSpriteEffects<MobModel>({\n  elementId: 'enemy',\n  animations: {\n    normal: [\n      fr(require('../../../assets/enemy/enemy-ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/enemy/enemy-explosion-00.png'), 0),\n      fr(require('../../../assets/enemy/enemy-explosion-01.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-02.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-03.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-04.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-05.png'), 75),\n    ],\n  },\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n  currentState: 'normal',\n  deathEvent: ON_ENEMY_DEATH,\n});\n","import { MobModel } from '../../../game/Domain/mob';\n\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Lasers/sfx_wpn_laser1.wav';\nimport DeathSound from '../../../audio/Explosions/Short/sfx_exp_short_hard12.wav';\nimport { ON_ENEMY_DEATH } from '../../../events';\n\n\nexport const AnimatedCrabBug = withSpriteEffects<MobModel>({\n  elementId: 'enemy',\n  animations: {\n    normal: [\n      fr(require('../../../assets/crab-bug/crab-bug-ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/enemy/enemy-explosion-00.png'), 0),\n      fr(require('../../../assets/enemy/enemy-explosion-01.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-02.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-03.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-04.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-05.png'), 75),\n    ],\n  },\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n  currentState: 'normal',\n  deathEvent: ON_ENEMY_DEATH,\n});\n","import { MobModel } from '../../../game/Domain/mob';\n\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Lasers/sfx_wpn_laser1.wav';\nimport DeathSound from '../../../audio/Explosions/Clusters/sfx_exp_cluster1.wav';\nimport { ON_ENEMY_DEATH } from '../../../events';\n\nexport const AnimatedHelmetBug = withSpriteEffects<MobModel>({\n  elementId: 'enemy',\n  animations: {\n    normal: [\n      fr(require('../../../assets/helmet-bug/helmet-bug-ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/enemy/enemy-explosion-00.png'), 0),\n      fr(require('../../../assets/enemy/enemy-explosion-01.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-02.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-03.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-04.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-05.png'), 75),\n    ],\n  },\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n  currentState: 'normal',\n  deathEvent: ON_ENEMY_DEATH,\n});\n","import { MobModel } from '../../../game/Domain/mob';\n\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Lasers/sfx_wpn_laser1.wav';\nimport DeathSound from '../../../audio/Explosions/Odd/sfx_exp_odd1.wav';\nimport { ON_ENEMY_DEATH } from '../../../events';\n\nexport const AnimatedPincerBug = withSpriteEffects<MobModel>({\n  elementId: 'enemy',\n  animations: {\n    normal: [\n      fr(require('../../../assets/pincer-bug/pincer-bug-ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/enemy/enemy-explosion-00.png'), 0),\n      fr(require('../../../assets/enemy/enemy-explosion-01.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-02.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-03.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-04.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-05.png'), 75),\n    ],\n  },\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n  currentState: 'normal',\n  deathEvent: ON_ENEMY_DEATH,\n});\n","import { MobModel } from '../../../game/Domain/mob';\n\nimport { withSpriteEffects } from '../../Hoc/withSpriteEffects';\nimport { fr } from '../../hooks/withAnimationState';\n\nimport ShootSound from '../../../audio/Weapons/Lasers/sfx_wpn_laser1.wav';\nimport DeathSound from '../../../audio/Explosions/Long/sfx_exp_long1.wav';\nimport { ON_ENEMY_DEATH } from '../../../events';\n\nexport const AnimatedSonicBug = withSpriteEffects<MobModel>({\n  elementId: 'enemy',\n  animations: {\n    normal: [\n      fr(require('../../../assets/sonic-enemy/sonic-enemy-ship.png'), 0)\n    ],\n    death: [\n      fr(require('../../../assets/enemy/enemy-explosion-00.png'), 0),\n      fr(require('../../../assets/enemy/enemy-explosion-01.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-02.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-03.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-04.png'), 100),\n      fr(require('../../../assets/enemy/enemy-explosion-05.png'), 75),\n    ],\n  },\n  sounds: {\n    shoot: ShootSound,\n    death: DeathSound,\n  },\n  currentState: 'normal',\n  deathEvent: ON_ENEMY_DEATH,\n});\n","\nimport { SpriteTextureIds } from \"../../game/catalogue\";\nimport { ConnectedPlayer } from \"./Player/Player\";\nimport { AnimatedBug, AnimatedCrabBug, AnimatedHelmetBug, AnimatedPincerBug, AnimatedSonicBug } from \"./NPCs\";\n\n\nexport const SpriteTextureCollection: TextureIdIndexed = {\n    [SpriteTextureIds.Player]:      ConnectedPlayer,\n    [SpriteTextureIds.Bug]:         AnimatedBug,\n    [SpriteTextureIds.CrabBug]:     AnimatedCrabBug,\n    [SpriteTextureIds.HelmetBug]:   AnimatedHelmetBug,\n    [SpriteTextureIds.PincerBug]:   AnimatedPincerBug,\n    [SpriteTextureIds.SonicBug]:    AnimatedSonicBug,\n}\n\ntype TextureIdIndexed = { [K in SpriteTextureIds]: any; }\n","\nimport { IEntity, WithComponentMeta, ISystemManager } from \"../../engine/types\";\nimport * as React from 'react';\n\nimport { MobModel } from \"../../game/Domain/mob\";\nimport { CharacterModel } from \"../../game/Domain/character\";\n\nimport { SpriteTextureCollection } from \"../Containers/Sprites\";\nimport { SpriteTextureIds } from \"../../game/catalogue\";\n\nexport interface WithTextureProps {\n  entity:     IEntity;\n  system:     ISystemManager;\n  onDeath?:   (entity: IEntity) => void;\n}\n\nexport type IModelType<P> = { model: WithComponentMeta<P>; system: ISystemManager };\n\nexport const withTexture = <P extends MobModel | CharacterModel> (\n  textureId: SpriteTextureIds,\n): React.ComponentType<WithTextureProps> => {\n  const ConnectedComponent: React.ComponentType<IModelType<P>> = SpriteTextureCollection[textureId]\n  function WithTextureHOC(props: WithTextureProps) {\n    const { entity, system, ...rest } = props;\n    const model = system.getEntityModel<P>(props.entity);\n    return <ConnectedComponent {...rest} model={model} system={system} />;\n  };\n\n  return WithTextureHOC;\n}\n","import { ISystemManager } from \"../engine/types\";\nimport { MouseEvent } from \"react\";\nimport { createEnemy } from \"../game/factories/enemy\";\nimport { withTexture } from \"./Hoc/withTexture\";\nimport { ILoadedEnemy } from \"./Levels/types\";\n\nexport function loadLevel(system: ISystemManager, enemyPositions: number[][]): ILoadedEnemy[] {\n  let enemies: ILoadedEnemy[] = [];\n\n  let x: number = 0;\n  let y: number = 0;\n\n  for (const row of enemyPositions) {\n    for (const enemyTypeId of row) {\n      if (enemyTypeId !== 0) {\n        const geometry = {\n          width:    64,\n          height:   64,\n        }\n  \n        const position = {\n          x:    x * geometry.width,\n          y:    y * geometry.height,\n        }\n  \n        const entity = createEnemy(system, enemyTypeId, JSON.stringify(position), position, position, geometry)\n        enemies.push({\n          component: withTexture(enemyTypeId),\n          entity,\n        });\n      }\n\n      x++;\n    }\n\n    x = 0;\n    y++;\n  }\n\n  return enemies;\n}\n\nexport function withBlur(handler: any) {\n  return (event: MouseEvent<HTMLButtonElement>): void | undefined => {\n    event.currentTarget.blur();\n    handler(event);\n  }\n}\n","import * as React from 'react';\n\ninterface Props {\n  updateFrequency?: number;\n}\n\ninterface State {\n  value: number;\n}\n\nexport class FPS extends React.Component<Props, State> {\n  private lastLoop: number = (new Date()).getMilliseconds();\n  private count: number = 1;\n  private fps: number = 0;\n  private throttled: boolean = false;\n  private handler: number | undefined;\n\n  static defaultProps = {\n    updateFrequency: 500,\n  }\n\n  state = {\n    value: 0,\n  }\n\n  componentDidMount() {\n    this.setFps(this.countFps());\n    this.loop();\n  }\n\n  componentWillUnmount() {\n    if (this.handler) {\n      cancelAnimationFrame(this.handler)\n    }\n  }\n\n  countFps = () => {\n    const currentLoop = (new Date()).getMilliseconds();\n    if (this.lastLoop > currentLoop) {\n      this.fps = this.count;\n      this.count = 1;\n    } else {\n      this.count += 1;\n    }\n    this.lastLoop = currentLoop;\n    return this.fps;\n  };\n  \n  loop = () => {\n    this.handler = requestAnimationFrame(() => {\n      this.setFps(this.countFps());\n      this.loop();\n    });\n  }\n\n  setFps = (value: number) => {\n    if (!this.throttled) {\n      this.setState({ value })\n      this.throttled = true;\n      this.handler = setTimeout(() => {\n        this.throttled = false;\n      }, this.props.updateFrequency)\n    }\n  }\n\n  render() {\n    return (\n      <div id=\"fps\">Fps: {this.state.value}</div>\n    );\n  }\n}\n","import { ISystemManager, IFactoryComponent } from '../../engine/types';\nimport * as React from 'react';\nimport './styles/Dev.style.css';\n\nimport { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Draggable from 'react-draggable';\n\nimport { pp } from '../../engine/utils';\nimport { withBlur } from '../utils';\nimport { withEntity } from '../Hoc/withEntity';\nimport { FPS } from './FPS';\n\ninterface Props {\n  system:   ISystemManager;\n  onStart:  () => void;\n  onStop:   () => void;\n  onTick:   () => void;\n  onSave:   () => void;\n  onLoad:   () => void;\n}\n\nconst EntityInspector = withEntity(props =>\n  <pre>{pp(props.model)}</pre>\n);\n\nexport const DevScreen = (props: Props) => {\n  const [entityId, setEntityId] = useState(0);\n\n  const [open, setOpen]         = useState(false);\n  const [dragging, setDrag]     = useState(false);\n\n  const setDragFalse = () => setDrag(false);\n  const setDragTrue  = () => setDrag(true);\n  const toggleOpen   = () => setOpen(!open);\n\n  const handleClick = () => {\n    dragging ? open : toggleOpen();\n    setDragFalse();\n  }\n\n  return (\n    <Draggable>\n      <div id=\"devscreen\" className={'container'}>\n\n        <div id=\"header\">\n          <span className=\"float-left title\" onMouseUp={handleClick} onMouseDown={setDragFalse} onMouseMove={setDragTrue}>\n            <h3>Devtools</h3>\n          </span>\n          <i id=\"close-x\" className=\"icon close float-right\" onClick={handleClick}></i>\n        </div>\n\n        <div className={classNames(!open && 'hidden')}>\n          <span className=\"links\">\n            <Link to=\"/intro\">Intro</Link>{' | '}\n            <Link to=\"/menu\">Menu</Link>{' | '}\n            <Link to=\"/game\">Game</Link>\n          </span>\n\n          <Buttons {...props} />\n\n          <p>Epoch: {props.system.epoch}</p>\n\n          <FPS />\n\n          <div id=\"entity-viewer\">\n            Entities\n            <select onChange={e => {\n              const value = e.currentTarget.value;\n              setEntityId(parseInt(value));\n            }}>\n              {props.system.getState().entities.map(o => {\n                const { name } = props.system.getEntityModel<IFactoryComponent>(o);\n                return <option key={o.id} value={o.id}>{name}</option>\n              })}\n            </select>\n            <div className=\"scrollable p-1\">\n              <EntityInspector entity={{ id: entityId }} system={props.system} />\n            </div>\n          </div>\n        </div>\n      </div>\n    </Draggable>\n  )\n}\n\nfunction Buttons(props: Props) {\n  return (\n    <>\n      <button className=\"btn is-primary\" onClick={withBlur(props.onStart)}>Start</button>\n      <button className=\"btn is-error\" onClick={withBlur(props.onStop)}>Stop</button>\n      <button className=\"btn is-success\" onClick={withBlur(props.onTick)}>Evolve</button>\n      <button className=\"btn\" onClick={withBlur(props.onSave)}>Save</button>\n      <button className=\"btn is-warning\" onClick={withBlur(props.onLoad)}>Load</button>\n    </>\n  )\n}\n\nexport function classNames(...classes: (string | boolean | undefined | null)[]) {\n  return classes.filter(o => typeof o === 'string').join(' ');\n}\n","import * as React from 'react';\nimport \"./styles/Layout.style.css\";\n\ninterface Props {\n  id?:            string;\n  className?:     string;\n  topLeft?:       React.ReactNode;\n  topCenter?:     React.ReactNode;\n  topRight?:      React.ReactNode;\n  middleLeft?:    React.ReactNode;\n  middleCenter?:  React.ReactNode;\n  middleRight?:   React.ReactNode;\n  bottomLeft?:    React.ReactNode;\n  bottomCenter?:  React.ReactNode;\n  bottomRight?:   React.ReactNode;\n  background?:    React.ReactNode;\n  children:       React.ReactNode;\n  after?:         React.ReactNode;\n}\n\nexport function Layout(props: Props) {\n  return (\n    <div id={props.id} className={`layout ${props.className}`}>\n      <div className=\"top left\">{props.topLeft}</div>\n      <div className=\"top center\">{props.topCenter}</div>\n      <div className=\"top right\">{props.topRight}</div>\n      <div className=\"middle left\">{props.middleLeft}</div>\n      <div className=\"middle center\">{props.middleCenter}</div>\n      <div className=\"middle right\">{props.middleRight}</div>\n      <div className=\"bottom left\">{props.bottomLeft}</div>\n      <div className=\"bottom center\">{props.bottomCenter}</div>\n      <div className=\"bottom right\">{props.bottomRight}</div>\n      <div className=\"background\">{props.background}</div>\n      <div className=\"gamescreen\">{props.children}</div>\n      {props.after}\n    </div>\n  )\n}\n  ","import * as React from 'react';\n\ninterface Props {\n    value: number;\n  }\n  \n  export function Lives(props: Props) {\n    return (\n      <div className=\"flex rows\">\n        <span>1UP</span>\n        <span>{props.value}</span>\n      </div>\n    )\n  }\n  ","import * as React from 'react';\n\ninterface Props {\n  value: number;\n}\n\nexport function HighScore(props: Props) {\n  return (\n    <div className=\"flex rows\">\n      <span>High Score</span>\n      <span className=\"center-text\">{props.value}</span>\n    </div>\n  )\n}\n","import * as React from 'react';\n\ninterface Props {\n  value: number;\n}\n\nexport function Credits(props: Props) {\n  return (\n    <span>Credits {props.value}</span>\n  )\n}\n","import * as React from 'react';\n\ninterface Props {\n  value: string | number | undefined;\n}\n\nexport function LevelStatus(props: Props) {\n  return props.value\n    ? <p>{`Level: ${props.value}`}</p>\n    : null;\n}\n","import * as React from 'react';\n\ninterface Props {\n  onClick: () => void;\n}\n\nexport function RestartButton(props: Props) {\n  return <button className=\"btn is-success\" onClick={props.onClick}>Restart</button>;\n}\n","import * as React from 'react';\nimport './styles/Overlay.style.css';\n\nimport { Layout } from \"./Base\";\nimport { Lives } from \"../Components/Lives\";\nimport { HighScore } from \"../Components/HighScore\";\nimport { Credits } from \"../Components/Credits\";\nimport { LevelStatus } from '../Components/LevelStatus';\nimport { RestartButton } from '../Components/RestartButton';\nimport { classNames } from '../Development/Dev';\n\ninterface Props {\n  id:         string;\n  className?: string;\n  level?:     string | number;\n  lives:      number;\n  score:      number;\n  credits:    number;\n  background: React.ReactNode;\n  children:   React.ReactNode;\n  onRestart: () => void;\n}\n\nexport function Gui(props: Props) {\n  return (\n    <Layout\n      id={props.id}\n      className={classNames(props.className, 'retro-container')}\n      topLeft={<Lives value={props.lives} />}\n      topCenter={<HighScore value={props.score} />}\n      topRight={<LevelStatus value={props.level} />}\n      bottomLeft={<Credits value={props.credits} />}\n      background={props.background}\n      bottomRight={<RestartButton onClick={props.onRestart} />}\n    >\n      {props.children}\n    </Layout>\n  )\n}\n","import * as React from 'react';\nimport './styles/StarField.style.css';\nimport './styles/Logo.style.css';\n\nexport function NewGame() {\n  return (\n    <div id=\"starfield\" className=\"background\">\n      <div id=\"stars\"></div>\n      <div id=\"stars2\"></div>\n      <div id=\"stars3\"></div>\n      <div id=\"logo-container\" className=\"slide-up\">\n        <div id=\"logo\"></div>\n      </div>\n    </div>\n  );\n}\n\nexport default NewGame;\n","\nexport function Key()\n{\n\tthis.pressed = false;\n\tthis.justPressed = false;\n\tthis.justReleased = false;\n}\n\n//Action List\nKey.DOWN = -1;\nKey.UP = 1;\nKey.RESET = 0;\n\n//Update key status based new state\nKey.prototype.update = function(action)\n{\n\tthis.justPressed = false;\n\tthis.justReleased = false;\n\n\tif(action === Key.DOWN)\n\t{\n\t\tif(!this.pressed)\n\t\t{\n\t\t\tthis.justPressed = true;\n\t\t}\n\t\tthis.pressed = true;\n\t}\n\telse if(action === Key.UP)\n\t{\n\t\tif(this.pressed)\n\t\t{\n\t\t\tthis.justReleased = true;\n\t\t}\n\t\tthis.pressed = false;\n\t}\n\telse if(action === Key.RESET)\n\t{\n\t\tthis.justReleased = false;\n\t\tthis.justPressed = false;\n\t}\n}\n\n//Set key status\nKey.prototype.set = function(justPressed, pressed, justReleased)\n{\n\tthis.pressed = pressed;\n\tthis.justPressed = justPressed;\n\tthis.justReleased = justReleased;\n}\n\n//Reset key to default values\nKey.prototype.reset = function()\n{\n\tthis.pressed = false;\n\tthis.justPressed = false;\n\tthis.justReleased = false;\n}\n","import {Key} from './Key';\n\n\nexport function Keyboard() {\n\tthis.keys = [];\n\tthis.actions = [];\n\n\t//Initialize Keys\n\tfor(let i = 0; i < 256; i++)\n\t{\n\t\tthis.keys.push(new Key());\n\t}\n\n\t//Events\n\tthis.events = [];\n\n\t//Actions pointer\n\tconst actions = this.actions;\n\n\t//Key down\n\tthis.events.push([window, \"keydown\", function(event)\n\t{\n\t\tactions.push(event.keyCode);\n\t\tactions.push(Key.DOWN);\n\t}]);\n\n\t//Key up\n\tthis.events.push([window, \"keyup\", function(event)\n\t{\n\t\tactions.push(event.keyCode);\n\t\tactions.push(Key.UP);\n\t}]);\n\n\t//Initialize events\n\tfor(let i = 0; i < this.events.length; i++)\n\t{\n\t\tvar event = this.events[i];\n\t\tevent[0].addEventListener(event[1], event[2]);\n\t}\n}\n\n//Update key flags syncronously\nKeyboard.prototype.update = function()\n{\n\tlet end = 0;\n\n\twhile(this.actions.length > end)\n\t{\n\t\tlet key = this.actions.shift();\n\t\tlet action = this.actions.shift();\n\n\t\tthis.keys[key].update(action);\n\n\t\tif(this.keys[key].justReleased || this.keys[key].justPressed)\n\t\t{\n\t\t\tthis.actions.push(key);\n\t\t\tthis.actions.push(Key.RESET);\n\t\t\tend += 2;\n\t\t}\n\t}\n}\n\n//Reset keyboard status\nKeyboard.prototype.reset = function()\n{\n\t//Clear actions array\n\tthis.actions = [];\n\n\t//Reset all keys\n\tfor(let i = 0; i < this.keys.length; i++)\n\t{\n\t\tthis.keys[i].reset();\n\t}\n}\n\n//Check if a key is pressed\nKeyboard.prototype.keyPressed = function(key)\n{\n\treturn this.keys[key].pressed;\n}\n\n//Check is a key as just pressed\nKeyboard.prototype.keyJustPressed = function(key)\n{\n\treturn this.keys[key].justPressed;\n}\n\n//Check if a key was just released\nKeyboard.prototype.keyJustReleased = function(key)\n{\n\treturn this.keys[key].justReleased;\n}\n\n//Dispose keyboard events\nKeyboard.prototype.dispose = function()\n{\n\tfor(let i = 0; i < this.events.length; i++)\n\t{\n\t\tlet event = this.events[i];\n\t\tevent[0].removeEventListener(event[1], event[2]);\n\t}\n}\n\n//Key codes\nKeyboard.TAB = 9;\nKeyboard.ENTER = 13;\nKeyboard.SHIFT = 16;\nKeyboard.CTRL = 17;\nKeyboard.ALT = 18;\nKeyboard.CAPS_LOCK = 20;\nKeyboard.ESC = 27;\nKeyboard.SPACEBAR = 32;\nKeyboard.PAGE_UP = 33;\nKeyboard.PAGE_DOWN = 34;\nKeyboard.END = 35;\nKeyboard.HOME = 36;\nKeyboard.INSERT = 45;\nKeyboard.DEL = 46;\n\nKeyboard.LEFT = 37;\nKeyboard.RIGHT = 39;\nKeyboard.UP = 38;\nKeyboard.DOWN = 40;\n\nKeyboard.NUM0 = 48;\nKeyboard.NUM1 = 49;\nKeyboard.NUM2 = 50;\nKeyboard.NUM3 = 51;\nKeyboard.NUM4 = 52;\nKeyboard.NUM5 = 53;\nKeyboard.NUM6 = 54;\nKeyboard.NUM7 = 55;\nKeyboard.NUM8 = 56;\nKeyboard.NUM9 = 57;\n\nKeyboard.A = 65;\nKeyboard.B = 66;\nKeyboard.C = 67;\nKeyboard.D = 68;\nKeyboard.E = 69;\nKeyboard.F = 70;\nKeyboard.G = 71;\nKeyboard.H = 72;\nKeyboard.I = 73;\nKeyboard.J = 74;\nKeyboard.K = 75;\nKeyboard.L = 76;\nKeyboard.M = 77;\nKeyboard.N = 78;\nKeyboard.O = 79;\nKeyboard.P = 80;\nKeyboard.Q = 81;\nKeyboard.R = 82;\nKeyboard.S = 83;\nKeyboard.T = 84;\nKeyboard.U = 85;\nKeyboard.V = 86;\nKeyboard.W = 87;\nKeyboard.X = 88;\nKeyboard.Y = 89;\nKeyboard.Z = 90;\n\nKeyboard.F1 = 112;\nKeyboard.F2 = 113;\nKeyboard.F3 = 114;\nKeyboard.F4 = 115;\nKeyboard.F5 = 116;\nKeyboard.F6 = 117;\nKeyboard.F7 = 118;\nKeyboard.F8 = 119;\nKeyboard.F9 = 120;\nKeyboard.F10 = 121;\nKeyboard.F11 = 122;\nKeyboard.F12 = 123;","import {useEffect} from 'react';\nimport { Keyboard } from '../../extern/Keyboard';\n\nexport const withEnterKeyEffect = (onEnter: () => void) => useEffect(() => {\n  const enterKeyHandler = (e: KeyboardEvent) => {\n    if (e.keyCode === Keyboard.ENTER) {\n      onEnter();\n    }\n  }\n\n  document.addEventListener('keypress', enterKeyHandler)\n\n  return function cleanup() {\n    document.removeEventListener('keypress', enterKeyHandler);\n  }\n}, []);\n","import { IGameState } from '../../game/types';\nimport * as React from 'react';\nimport {useEffect, useState} from 'react';\n\nimport { Gui } from '../Layouts/Gui';\nimport StarFieldLogo from '../Backgrounds/NewGame';\n\nimport { withEnterKeyEffect } from '../hooks/withEnterKeyEffect';\nimport { ON_START_GAME } from '../../events';\n\nimport { classNames } from '../Development/Dev';\nimport { Songs, Sfx } from '../../game/catalogue';\nimport { once } from '../../engine/utils';\n\n\nexport function Menu(props: IGameState) {\n  const [ready, setReady] = useState(false);\n\n  function handleStartGame() {\n    setTimeout(() => {\n      props.system.audio.playSound(Sfx.LEVEL_WIN);\n    }, 750);\n\n    setTimeout(() => {\n      props.system.events.emit(ON_START_GAME);\n    }, 2000);\n  }\n\n  useEffect(() => {\n    setTimeout(() => setReady(true), 3000);\n  }, []);\n\n  useEffect(() => {\n    props.system.audio.playSong(Songs.MENU);\n\n    return () => {\n      props.system.audio.stopSong(Songs.MENU);\n    }\n  }, []);\n\n  withEnterKeyEffect(once(handleStartGame));\n\n  return (\n    <Gui\n      id=\"gui\"\n      className=\"menu\"\n      score={0}\n      credits={0}\n      lives={0}\n      background={<StarFieldLogo />}\n      onRestart={handleStartGame}\n    >\n      <div className=\"screen menu\">\n        <div id=\"press-enter\" className=\"center-content\">\n          <p className={classNames(!ready && 'hidden', 'fade-in', 'neon', 'retro-red')} onMouseUp={handleStartGame}>\n            <span>Press Enter</span>\n          </p>\n        </div>\n      </div>\n      <div className=\"overlay\">AV-1</div>\n    </Gui>\n  )\n}\n","import * as React from 'react';\nimport './styles/StarField.style.css';\n\nexport function StarField() {\n  return (\n    <div id=\"starfield\" className=\"background\">\n      <div id=\"stars\"></div>\n      <div id=\"stars2\"></div>\n      <div id=\"stars3\"></div>\n    </div>\n  );\n}\n\nexport default StarField;\n","import * as React from 'react';\n\nexport class Level extends React.PureComponent {\n  render() {\n    return (\n      <div className=\"screen level\">\n        {this.props.children}\n      </div>\n    );\n  }\n}\n","import { ISystemManager } from '../../../engine/types';\nimport * as React from 'react';\nimport { ProjectileModel } from '../../../game/Domain/projectile';\n\ninterface Props {\n  system: ISystemManager;\n  model:  ProjectileModel;\n}\n\nexport function Bullet(props: Props) {\n  const styles = getStyles(props);\n\n  return (\n    <div id=\"bullet\" className=\"sprite\" style={styles} />\n  )\n}\n\nfunction getStyles(props: Props): React.CSSProperties {\n  return {\n    position:     'absolute',\n    outline:      '1px solid white',\n    borderRadius: '25%',\n    height:       '32px',\n    width:        '0px',\n    left:         props.model.position.x + 30,\n    top:          props.model.position.y,\n    display:      cssDisplayValue(props.model),\n  }\n}\n\nfunction cssDisplayValue(model: ProjectileModel) {\n  return (model.offscreen) ? 'none' : ''\n}\n","import { ISystemManager, IComponent, IEntity } from '../../engine/types';\nimport { LevelProps, ILoadedEnemy } from '../Levels/types';\nimport * as React from 'react';\n\nimport { Level } from '../Levels/Base';\n\nimport { ConnectedPlayer } from '../Containers/Player/Player';\nimport { Bullet } from '../Containers/Weapons/Bullet';\n\nimport { ON_DEATH, ON_LEVEL_COMPLETE, ON_ENEMY_FREE, ON_ENEMY_GROUP, ON_LEVEL_BEGIN, ON_PLAYER_DEATH, ON_ENEMY_DEATH, ON_REVIVE_PLAYER } from '../../events';\nimport { WithRandomWalk } from '../../engine/components/withRandomWalk';\nimport { once } from '../../engine/utils';\nimport { WithHealth } from '../../engine/components/killable';\n\nfunction arrayRandom<T>(items: T[]) {\n  return items[Math.floor(Math.random()*items.length)];\n}\n\nconst ENEMY_FREE_INTERVAL = 2000;\n\ninterface WithGameLevelOptions {\n  enemyPositions: number[][];\n  levelId:        string | number;\n  completeEvent?: string;\n}\n\nexport const withGameLevel = (\n  options: WithGameLevelOptions\n): React.ComponentType<LevelProps> => {\n  return class LevelHOC extends React.Component<LevelProps, State> {\n    private interval: any;\n\n    state = {\n      enemyPositions: options.enemyPositions,\n      levelId:        options.levelId,\n      \n      enemies:        [] as ILoadedEnemy[],\n      enemiesDead:    0,\n      ready:          false,\n    }\n  \n    componentDidMount() {\n      const {enemyPositions} = this.state;\n      const {system, loadLevel} = this.props;\n  \n      const enemies = loadLevel(system, enemyPositions);\n  \n      this.setState({ enemies, ready: true })\n  \n      system.events.registerListener(ON_DEATH,        this.handleDeath);\n      system.events.registerListener(ON_ENEMY_FREE,   this.enemyFree);\n      system.events.registerListener(ON_ENEMY_GROUP,  this.enemyGroup);\n      system.events.registerListener(ON_LEVEL_BEGIN,  this.startFreeEnemyInterval);\n      system.events.registerListener(ON_REVIVE_PLAYER, this.stopAllFreeEnemies);\n    }\n  \n    componentDidUpdate(nextProps: LevelProps, nextState: State) {\n      if (!nextState.ready) {\n        return;\n      }\n  \n      if (nextState.enemiesDead === nextState.enemies.length) {\n        this.onLevelComplete(this.props.system, this.state.levelId);\n      }\n    }\n  \n    componentWillUnmount() {\n      const {system} = this.props;\n\n      clearInterval(this.interval);\n      \n      system.events.unRegisterListener(ON_DEATH,        this.handleDeath);\n      system.events.unRegisterListener(ON_ENEMY_FREE,   this.enemyFree);\n      system.events.unRegisterListener(ON_ENEMY_GROUP,  this.enemyGroup);\n      system.events.unRegisterListener(ON_LEVEL_BEGIN,  this.startFreeEnemyInterval);\n      system.events.unRegisterListener(ON_REVIVE_PLAYER, this.stopAllFreeEnemies);\n      \n      this.state.enemies.forEach(o =>\n        system.unRegisterEntity(o.entity.id)\n      );\n    }\n  \n    handleDeath = (component: IComponent<WithHealth>, entity: IEntity) => {\n      if (this.state.enemies.find(o => o.entity.id === component.entityId)) {\n        this.props.system.events.emit(ON_ENEMY_DEATH, component)\n\n        this.setState(state => ({\n          enemiesDead: state.enemiesDead + 1,\n        }));\n\n      } else {\n        this.props.system.events.emit(ON_PLAYER_DEATH, component)\n      }\n    }\n  \n    onLevelComplete = (system: ISystemManager, level: number | string) => {\n      system.events.emit(options.completeEvent || ON_LEVEL_COMPLETE, level);\n      this.stopFreeEnemyInterval();\n    }\n  \n    enemyFree = () => {\n      const maybeComponent = arrayRandom(this.state.enemies.map(o => o.entity));\n\n      const controlComponent = this.props.system\n        .getEntityComponent<WithRandomWalk>(maybeComponent, 'controls');\n\n      if (controlComponent) {\n        controlComponent.state.disabled = false;\n      }\n    }\n  \n    stopAllFreeEnemies = () => {\n\n      this.stopFreeEnemyInterval();\n\n      this.state.enemies.forEach(o => {\n        o.entity\n        const controlComponent = this.props.system\n          .getEntityComponent<WithRandomWalk>(o.entity, 'controls');\n\n        if (controlComponent) {\n          controlComponent.state.disabled = true;\n        }\n      });\n    }\n\n    enemyGroup = () => {}\n   \n    startFreeEnemyInterval = () => {\n      this.interval = setInterval(() => {\n        this.props.system.events.emit(ON_ENEMY_FREE);\n      }, ENEMY_FREE_INTERVAL);\n    }\n   \n    stopFreeEnemyInterval = () => {\n      clearInterval(this.interval);\n    }\n\n    render() {\n      const {player, bullet1, bullet2, system} = this.props.state;\n      return (\n        <Level>\n    \n          <ConnectedPlayer entity={player} system={system} />\n    \n          <Bullet model={bullet1} system={system} />\n          <Bullet model={bullet2} system={system} />\n    \n          {this.state.enemies.map((enemy: ILoadedEnemy) => {\n            const ConnectedEnemy = enemy.component;\n            return (\n              <ConnectedEnemy\n                key={enemy.entity.id}\n                entity={enemy.entity}\n                system={system}\n              />\n            )\n          })\n        }\n        </Level>\n      )\n    }\n  }\n}\n\ninterface State {\n  enemies:          ILoadedEnemy[];\n  enemyPositions:   number[][];\n  enemiesDead:      number;\n  levelId:          string | number;\n  ready:            boolean;\n}\n","import { ILevel, ILevels } from \"./types\";\n\nimport { Demo } from \"./Demo/Demo\";\nimport { Level1 } from \"./1/Level.1\";\nimport { Level2 } from \"./2/Level.2\";\nimport { Level3 } from \"./3/Level.3\";\nimport { Level4 } from \"./4/Level.4\";\nimport { End } from \"./End/End\";\n\nexport const Levels = {\n\tdemo: \t\t{\n    level: Demo,\n    next: 'level1',\n  },\n\tlevel1: \t{\n    level: Level1,\n    next: 'level2',\n  },\n\tlevel2: \t{\n    level: Level2,\n    next: 'level3',\n  },\n\tlevel3: \t{\n    level: Level3,\n    next: 'level4',\n  },\n\tlevel4: \t{\n    level: Level4,\n    next: 'end',\n  },\n\tend: \t{\n    level: End,\n    next: 'demo',\n  },\n}\n\nexport const humanizedLevelNames = {\n  demo:   'Demo',\n  level1: '1',\n  level2: '2',\n  level3: '3',\n  level4: '4',\n  end:    'End',\n}\n\nexport function getThisLevel(current: ILevel, directory: ILevels = Levels) {\n  return directory[current].level;\n}\n\nexport function getNextLevel(current: ILevel, directory: ILevels = Levels) {\n  return directory[current].next as ILevel;\n}\n","import { withGameLevel } from '../../Hoc/withGameLevel';\n\nexport const Demo = withGameLevel({\n  enemyPositions: [\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],\n    [0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0],\n    [0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0],\n  ],\n  levelId: 'Demo',\n});\n","import { withGameLevel } from '../../Hoc/withGameLevel';\n\nexport const Level1 = withGameLevel({\n  enemyPositions: [\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],\n  ],\n  levelId: '1',\n});\n","import { withGameLevel } from '../../Hoc/withGameLevel';\n\nexport const Level2 = withGameLevel({\n  enemyPositions: [\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],\n    [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],\n  ],\n  levelId: '2',\n});\n","import { withGameLevel } from '../../Hoc/withGameLevel';\n\nexport const Level3 = withGameLevel({\n  enemyPositions: [\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 5, 5, 5, 5, 5, 5, 0, 0, 0],\n    [0, 0, 0, 3, 3, 0, 0, 3, 3, 0, 0, 0],\n    [0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0],\n    [0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0],\n  ],\n  levelId: '3',\n});\n","import { withGameLevel } from '../../Hoc/withGameLevel';\nimport { ON_GAME_OVER } from '../../../events';\n\nexport const Level4 = withGameLevel({\n  enemyPositions: [\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],\n    [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],\n    [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],\n    [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],\n    [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],\n  ],\n  levelId: '4',\n\n  completeEvent: ON_GAME_OVER,\n});\n","import { LevelProps } from '../types';\nimport * as React from 'react';\n\nimport { ConnectedPlayer } from '../../Containers/Player/Player';\n\nimport { Level } from '../Base';\n\n\nexport function End(props: LevelProps) {\n  const {player, system} = props.state;\n  return (\n    <Level>\n      <ConnectedPlayer entity={player} system={system} />\n    </Level>\n  )\n}\n","import * as React from 'react';\nimport { classNames } from '../Development/Dev';\n\ninterface Props {\n  level:    string;\n  retries : number;\n  onReady:  () => void;\n}\n\nexport function Countdown(props: Props) {\n  const [time, setTime] = React.useState(5);\n  const [ready, setReady] = React.useState(false);\n\n  React.useEffect(() => {\n    let END = 5;\n    \n    setTime(END);\n    setReady(false);\n  \n    for (let i = 0; i <= END; i++) {\n\n      setTimeout(() => setTime(END - i), i * 1000);\n    }\n  \n    setTimeout(() => {\n      setReady(true);\n      props.onReady();\n    }, END * 1000);\n  }, [props.level, props.retries])\n\n  return (\n    <div className={classNames(\"center-content\", \"absolute-fit\", ready ? 'fadeout' : 'fadeout-visible')}>\n      <p className=\"neon green\">\n        <span>{time}</span>\n      </p>\n    </div>\n  );\n}\n","import { ISystemManager } from '../../engine/types';\nimport { IGameState } from '../../game/types';\nimport { ILevels, ILevel } from './types';\nimport * as React from 'react';\n\nimport { Countdown } from '../Components/Countdown'\nimport { Levels, getThisLevel } from './Directory';\nimport { loadLevel } from '../utils';\nimport { ON_LEVEL_BEGIN, ON_LEVEL_LOAD, ON_REVIVE_PLAYER } from '../../events';\n\ninterface Props {\n\tlevels?:  \t\tILevels;\n\tcurrentLevel: ILevel;\n\tstate:    \t\tIGameState;\n\tsystem:   \t\tISystemManager;\n}\n\nexport function Loader({\n\tlevels = Levels,\n\t...rest\n}: Props) {\n\tconst [ready, setReady] = React.useState(false);\n\tconst [retries, setRetries] = React.useState(0);\n\tconst [level, setLevel] = React.useState(rest.currentLevel);\n\n  const GameLevel = getThisLevel(rest.currentLevel);\n\t\n\tReact.useEffect(() => {\n\t\trest.system.events.emit(ON_LEVEL_LOAD)\n\t\tsetLevel(rest.currentLevel);\n\t\tsetReady(false);\n\t}, [rest.currentLevel])\n\t\n\tReact.useEffect(() => {\n    const onRevivePlayer = () => {\n      setRetries(retries + 1);\n\t\t\tsetReady(false);\n    }\n\n\t\trest.system.events.registerListener(ON_REVIVE_PLAYER, onRevivePlayer);\n    \n    return () => {\n      rest.system.events.unRegisterListener(ON_REVIVE_PLAYER, onRevivePlayer);\n    }\n\t}, [])\n\n\tconst onCountdownFinished = () => {\n\t\trest.system.events.emit(ON_LEVEL_BEGIN, level)\n\t\tsetReady(true);\n\t}\n\n  return (\n\t\t<>\n\t\t\t<GameLevel\n\t\t\t\tloadLevel={loadLevel}\n\t\t\t\t{...rest}\n\t\t\t/>\n\n\t\t\t<Countdown\n\t\t\t\tretries={retries}\n\t\t\t\tlevel={level}\n\t\t\t\tonReady={onCountdownFinished}\n\t\t\t/>\n\t\t</>\n  );\n}\n","import { ICurrentGameState } from '../../game/types';\nimport { ILevel } from '../Levels/types';\nimport * as React from 'react';\n\nimport { withEnterKeyEffect } from '../hooks/withEnterKeyEffect';\n\nimport { humanizedLevelNames } from '../Levels';\nimport { once } from '../../engine/utils';\n\ninterface Props {\n  currentLevel: ILevel;\n  state:        ICurrentGameState;\n  onNextLevel:  () => void;\n}\n\nexport function LevelSummary(props: Props) {\n  withEnterKeyEffect(once(props.onNextLevel));\n  return (\n    <div className=\"complete container with-title is-center is-dark fade-in\">\n      <label className=\"title\">{`Level ${humanizedLevelNames[props.currentLevel]} Complete`}</label>\n\n      <p>{`Score:  ${props.state.score}`}</p>\n      <p>{`Shots:  ${props.state.shots}`}</p>\n      <p>{`Hits:   ${props.state.hits}`}</p>\n      <p>{`Ratio:  ${Math.round(props.state.hits / props.state.shots * 100)}%`}</p>\n\n      <button className=\"btn is-primary\" onClick={props.onNextLevel}>Press Enter</button>\n    </div>\n  )\n}\n","import { IVector, IEntity, IComponent } from '../../engine/types';\nimport { IGameState, IPointsLoot, ICurrentGameState } from '../../game/types';\nimport { ILevel } from '../Levels/types';\nimport * as React from 'react';\n\nimport StarField from '../Backgrounds/StarField';\nimport { Gui } from '../Layouts/Gui';\n\nimport { ProjectileModel } from '../../game/Domain/projectile';\nimport { WithHealthState } from '../../engine/components/killable';\nimport { WithPositionState, setPositionState } from '../../engine/components/withPosition';\nimport { IsLootable } from '../../engine/components/lootable';\n\nimport { Loader, humanizedLevelNames } from '../Levels';\nimport { LevelSummary } from '../Components/LevelSummary';\n\nimport { first, clamp } from '../../engine/utils';\n\nimport { ON_LEVEL_COMPLETE, ON_GAME_OVER, ON_PLAYER_ATTACK, ON_LEVEL_LOAD, ON_LEVEL_BEGIN, ON_START_ENGINE, ON_STOP_ENGINE, ON_PLAYER_DEATH, ON_ENEMY_DEATH, ON_COLLISION, ON_REVIVE_PLAYER } from '../../events';\nimport { getNextLevel } from '../Levels/Directory';\nimport { Sfx, Songs } from '../../game/catalogue';\nimport { WithControls } from '../../engine/components/withControls__unused';\nimport { MobModel } from '../../game/Domain/mob';\nimport { CharacterModel } from '../../game/Domain/character';\nimport { WithHomePosition } from '../../engine/components/withHomePosition';\n\ntype LootablePoints = IsLootable<IPointsLoot>;\n\ninterface Props extends IGameState {\n  onRestart:  () => void;\n}\n\nexport class Game extends React.PureComponent<Props, ICurrentGameState> {\n  constructor(props: Props) {\n    super(props);\n\n    this.registerEvents();\n  }\n\n  state = {\n    score:              0,\n    credits:            1,\n    lives:              3,\n    shots:              0,\n    hits:               0,\n    complete:           false,\n    completed:          [],\n    currentLevel:       'level1' as ILevel,\n  }\n\n  componentDidMount() {\n    this.props.system.audio.playSong(Songs.GAME);\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (!this.props.player.attacking && nextProps.player.attacking) {\n      this.fireBullet(this.props.player.center);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.system.audio.stopSong(Songs.GAME);\n    this.unRegisterEvents();\n  }\n\n  registerEvents = () => {\n    this.props.system.events.registerListener(ON_LEVEL_LOAD,      this.handleLevelLoading);\n    this.props.system.events.registerListener(ON_LEVEL_BEGIN,     this.handleLevelBegin);\n    this.props.system.events.registerListener(ON_LEVEL_COMPLETE,  this.handleLevelComplete);\n    this.props.system.events.registerListener(ON_PLAYER_DEATH,    this.onPlayerDeath);\n    this.props.system.events.registerListener(ON_REVIVE_PLAYER,   this.onPlayerRevive);\n    this.props.system.events.registerListener(ON_ENEMY_DEATH,     this.onEnemyDeath);\n    this.props.system.events.registerListener(ON_GAME_OVER,       this.handleGameOver);\n    this.props.system.events.registerListener(ON_COLLISION,       this.handleCollision);\n  }\n\n  unRegisterEvents = () => {\n    this.props.system.events.unRegisterListener(ON_LEVEL_LOAD,      this.handleLevelLoading);\n    this.props.system.events.unRegisterListener(ON_LEVEL_BEGIN,     this.handleLevelBegin);\n    this.props.system.events.unRegisterListener(ON_LEVEL_COMPLETE,  this.handleLevelComplete);\n    this.props.system.events.unRegisterListener(ON_PLAYER_DEATH,    this.onPlayerDeath);\n    this.props.system.events.unRegisterListener(ON_REVIVE_PLAYER,   this.onPlayerRevive);\n    this.props.system.events.unRegisterListener(ON_ENEMY_DEATH,     this.onEnemyDeath);\n    this.props.system.events.unRegisterListener(ON_GAME_OVER,       this.handleGameOver);\n    this.props.system.events.unRegisterListener(ON_COLLISION,       this.handleCollision);\n  }\n\n  getBullet = (): ProjectileModel => {\n    return first([\n      this.props.bullet1,\n      this.props.bullet2,\n    ].filter(model => !!model.offscreen ))\n  }\n\n  fireBullet = (pos: IVector): void => {\n    const bullet = this.getBullet();\n\n    if (!bullet) {\n      return;\n    }\n\n    bullet.position.x = pos.x;\n    bullet.position.y = pos.y;\n\n    this.reviveEntity(bullet, 1);\n\n    this.setState(state => ({\n      ...state,\n      shots: state.shots + 1,\n    }));\n\n    this.props.system.events.emit(ON_PLAYER_ATTACK, this.props.player)\n  }\n\n  killEntity = (entity: IEntity) => {\n    const component = this.props.system\n      .getEntityComponent<WithHealthState>(entity, 'health');\n\n    if (component === undefined) {\n      return;\n    }\n\n    component.state.health.value = 0;\n  }\n\n  reviveEntity = (entity: IEntity, health: number): void => {\n    const component = this.props.system\n      .getEntityComponent<WithHealthState>(entity, 'health');\n\n    if (component === undefined) {\n      return;\n    }\n  \n    component.state.health.value = health;\n  }\n\n  handleCollision = (component: IComponent, entity: IEntity) => {\n    if (this.props.player.id === entity.id) {\n      this.props.system.events.emit(ON_PLAYER_DEATH, component)\n    } else {\n      this.props.system.events.emit(ON_ENEMY_DEATH, component)\n    }\n  }\n\n  onPlayerRevive = () => {\n    this.reviveEntity(this.props.player, 100);\n  }\n\n  onPlayerDeath = (player: IComponent) => {\n\n    if (this.state.lives === 0) {\n      this.handleGameOver();\n      return;\n    }\n\n    this.handleLevelLoading();\n\n    setTimeout(() => {\n      this.props.system.events.emit(ON_REVIVE_PLAYER);\n    }, 850);\n\n    this.setState(state => ({\n      lives: clamp(0, Infinity, state.lives - 1),\n    }));\n  }\n\n  onEnemyDeath = (source: IComponent): void => {\n    const component = this.props.system\n      .getEntityComponent<LootablePoints>({ id: source.entityId }, 'loot');\n\n    if (component === undefined) {\n      return;\n    }\n  \n    const points = component.state.loot!.points;\n\n    this.setState(state => ({\n      score: state.score + points,\n      hits: state.hits + 1,\n    }));\n  }\n\n  handleLevelLoading = (): void => {\n    this.props.system.events.emit(ON_STOP_ENGINE)\n        \n    const controls: IComponent<WithPositionState>[] = this.props.system.getState().components.filter(o => o.name === 'position');\n    const homePositions: IComponent<WithHomePosition>[] = this.props.system.getState().components.filter(o => o.name === 'homePosition');\n\n    controls.forEach(component => {\n      component.state.controllable = false;\n    })\n    homePositions.forEach(component => {\n      component.state.goHome = true;\n    })\n\n    this.props.system.events.emit(ON_START_ENGINE)\n  }\n  \n  handleLevelBegin = (): void => {\n    const controls: IComponent<WithPositionState>[] = this.props.system.getState().components.filter(o => o.name === 'position');\n    const homePositions: IComponent<WithHomePosition>[] = this.props.system.getState().components.filter(o => o.name === 'homePosition');\n    \n    controls.forEach(component => {\n      component.state.controllable = true;\n    })\n    homePositions.forEach(component => {\n      component.state.goHome = false;\n    })\n  }\n\n  handleLevelComplete = (level: string | number): void => {\n    this.props.system.audio.stopSong(Songs.GAME);\n    \n    setTimeout(() => {\n      this.props.system.audio.playSound(Sfx.LEVEL_WIN);\n    }, 750);\n    \n    setTimeout(() => {\n      this.props.system.audio.playSong(Songs.SUMMARY);\n\n      this.setState(state => ({\n        complete: true,\n        completed: state.completed.concat(level),\n      }));\n    }, 1500);\n  }\n\n  handleGameOver = (): void => {\n    this.props.system.audio.stopSong(Songs.GAME);\n\n    setTimeout(() => {\n      this.props.system.audio.playSound(Sfx.LEVEL_WIN);\n    }, 1500);\n\n    setTimeout(() => {\n      this.props.system.audio.playSound(Sfx.GAMEOVER);\n    }, 2250);\n\n    setTimeout(() => {\n      window.location.assign(`/end?final=${JSON.stringify({\n        score:    this.state.score,\n        hits:     this.state.hits,\n        shots:    this.state.shots,\n        lives:    this.state.lives,\n        credits:  this.state.credits,\n      })}`);\n    }, 3000);\n  }\n\n  startNewGame = (): void => {\n    this.props.system.audio.playSound(Sfx.NEW_GAME);\n\n    setTimeout(() => this.setState({ currentLevel: 'level1' }), 5);\n  }\n\n  onNextLevel = (): void => {\n    this.props.system.audio.stopSong(Songs.SUMMARY);\n    \n    setTimeout(() => {\n      this.props.system.audio.playSound(Sfx.NEXT_LEVEL);\n    }, 350);\n\n    setTimeout(() => {\n      const currentLevel = this.state.currentLevel;\n      const nextLevel = getNextLevel(currentLevel);\n\n      this.setState({ currentLevel: nextLevel as ILevel, complete: false })\n    }, 1200);\n\n    setTimeout(() => {\n      this.props.system.audio.playSong(Songs.GAME);\n    }, 3000);\n  }\n\n  render() {\n    const {currentLevel, score, credits, lives} = this.state;\n    return (\n      <Gui\n        id=\"gui\"\n        className=\"game\"\n        level={humanizedLevelNames[currentLevel]}\n        score={score}\n        credits={credits}\n        lives={lives}\n        onRestart={this.props.onRestart}\n        background={<StarField />}\n      >\n        <Loader\n          currentLevel={currentLevel}\n          state={this.props}\n          system={this.props.system}\n        />\n\n        {this.state.complete ? (\n          <div className=\"center-content absolute-fit\">\n            <LevelSummary\n              currentLevel={currentLevel}\n              state={this.state}\n              onNextLevel={this.onNextLevel}\n            />\n          </div>\n        ) : null}\n      </Gui>\n    )\n  }\n}\n","import * as React from 'react';\nimport './styles/StarField.style.css';\nimport './styles/GameOver.style.css';\n\nexport function GameOver() {\n  return (\n    <div id=\"starfield\" className=\"background\">\n      <div id=\"stars\"></div>\n      <div id=\"stars2\"></div>\n      <div id=\"stars3\"></div>\n      <div id=\"gameover-container\" className=\"slide-up\">\n        <div id=\"gameover\"></div>\n      </div>\n    </div>\n  );\n}\n\nexport default GameOver;\n","import { IGameState } from '../../game/types';\nimport * as React from 'react';\nimport {useEffect, useState} from 'react';\n\nimport { Gui } from '../Layouts/Gui';\nimport GameOver from '../Backgrounds/GameOver';\n\nimport { classNames } from '../Development/Dev';\nimport { withEnterKeyEffect } from '../hooks/withEnterKeyEffect';\nimport { Songs } from '../../game/catalogue';\nimport { once } from '../../engine/utils';\n\ninterface FinalScore {\n  score:    number;\n  hits:     number;\n  shots:    number;\n  lives:    number;\n  credits:  number;\n}\n\nexport function Outro(props: IGameState) {\n  const [ready, setReady] = useState(false);\n  const [final, setFinalScore] = useState<FinalScore>({} as FinalScore);\n\n  function handleStartNewGame() {\n    window.location.assign('/game');\n  }\n\n  function handleRestartGame() {\n    window.location.assign('/menu');\n  }\n\n  useEffect(() => {\n    props.system.audio.playSong(Songs.END);\n    return () => {\n      props.system.audio.stopSong(Songs.END);\n    }\n  }, []);\n\n  useEffect(() => {\n    const serialized = getQueryParams(window.location.search);\n\n    if (serialized && typeof serialized.final === 'string') {\n      try {\n        setFinalScore(JSON.parse(serialized.final));\n      } catch (e) {\n        // meh\n      }\n    }\n\n    const timer = setTimeout(() => setReady(true), 3000);\n\n    return () => {\n      clearTimeout(timer)\n    }\n  }, []);\n\n  withEnterKeyEffect(once(handleStartNewGame));\n\n  return (\n    <Gui\n      id=\"gui\"\n      className=\"gameover\"\n      score={final.score}\n      credits={final.credits}\n      lives={final.lives}\n      background={<GameOver />}\n      onRestart={handleRestartGame}\n    >\n      <div className=\"screen menu\">\n        <div id=\"press-enter\" className=\"center-content\">\n          <p className={classNames(!ready && 'hidden', 'fade-in')}>\n            Press Enter to Play Again\n          </p>\n        </div>\n      </div>\n    </Gui>\n  )\n}\n\nfunction getQueryParams(qs: string) {\n  const searchString = qs.split('+').join(' ');\n\n  let params: any = {};\n  let tokens: RegExpExecArray | null;\n  const re = /[?&]?([^=]+)=([^&]*)/g;\n\n  while (tokens = re.exec(searchString)) {\n      params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n  }\n\n  return params;\n}\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter } from \"../utils\";\n\nconst COMPONENT_NAMESPACE = 'attack';\n\nexport type WithAttack = { attacking: boolean; attackPower: number; };\n\nexport function combatableFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithAttack, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithAttack>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { attacking: state.attacking, attackPower: state.attackPower },\n        update: (system: ISystemManager, component: IAttackableEntity) => {\n            handleAttack(component, system);\n        },\n      }))\n  }\n}\n\ntype IAttackableEntity = IComponent<WithAttack>\n\nfunction handleAttack(component: IAttackableEntity, system: ISystemManager) {\n  if (system.input.keyPressed(system.input.KeyCodes.SPACEBAR)) {\n    component.state.attacking = true;\n  } else {\n    component.state.attacking = false;\n  }\n}\n\nexport const selectCombatableState = createSelector<IAttackableEntity>(COMPONENT_NAMESPACE);\nexport const setCombatableState    = createSetter<IAttackableEntity>(selectCombatableState);\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { WithPosition } from \"./withPosition\";\nimport { factory } from \"../utils\";\nimport { WithBoundary } from \"./withBoundary\";\n\nexport type WithControls = { direction: IVector; moving: boolean; speed: IVector; disabled?: boolean; };\n\nexport function withPlayerControlsFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithControls, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithControls>>({\n        id,\n        entityId: entity.id,\n        name: 'controls',\n        state: {\n          direction: state.direction,\n          moving: state.moving,\n          speed: state.speed,\n          disabled: !!state.disabled,\n        },\n        update: (system: ISystemManager, component: IPlayerControllableEntity) => {\n          handleVerticalMovement(entity, component, system);\n          handleHorizontalMovement(entity, component, system);\n          \n          handleMovingFlag(entity, component, system);\n        },\n      }))\n  }\n}\n\nexport type IPlayerControllableEntity = IComponent<WithControls & Partial<WithPosition> & Partial<WithBoundary>>\n\nfunction handleVerticalMovement(entity: IEntity, component: IPlayerControllableEntity, system: ISystemManager) {\n  handleMovement(entity, component, system, 'vertical');\n}\n\nfunction handleHorizontalMovement(entity: IEntity, component: IPlayerControllableEntity, system: ISystemManager) {\n  handleMovement(entity, component, system);\n}\n\nfunction handleMovement(entity: IEntity, component: IPlayerControllableEntity, system: ISystemManager, direction: 'vertical' | 'horizontal' = 'horizontal') {\n\n  if (component.state.disabled) {\n    return;\n  }\n\n  const key = direction === 'horizontal' ? 'x' : 'y';\n  const [neg, pos] = direction === 'horizontal'\n    ? [system.input.KeyCodes.LEFT, system.input.KeyCodes.RIGHT]\n    : [system.input.KeyCodes.UP,   system.input.KeyCodes.DOWN];\n\n  if (system.input.keyPressed(pos)) {\n    component.state.direction[key] = 1;\n  } else\n  if (system.input.keyPressed(neg)) {\n    component.state.direction[key] = -1;\n  } else {\n    component.state.direction[key] = 0;\n  }\n}\n\nfunction handleMovingFlag(entity: IEntity, component: IPlayerControllableEntity, system: ISystemManager) {\n  const {x, y} = component.state.direction;\n  if (x === 0 && y === 0) {\n    component.state.moving = false;\n  } else {\n    component.state.moving = true;\n  }\n}\n","import { IComponent, ISystemManager, IEntity, EntityIdType, Bounds, IVector, IDimensions, IComponentEvents } from \"../types\";\nimport { factory, createSelector, createSetter } from \"../utils\";\nimport { WithGeometry } from \"./withGeometry\";\nimport { WithPosition } from \"./withPosition\";\nimport { ON_COLLISION } from \"../../events\";\nimport { IsCollidable } from \"./isCollidable\";\n\nconst COMPONENT_NAMESPACE = 'collisions';\n\nexport type WithCollisionArgs = Partial<WithCollisions>;\nexport type WithCollisions = { collisions: EntityIdType[]; collisionGroup: string; };\n\nexport function withCollisionsFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithCollisionArgs, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithCollisionArgs>>({\n        id,\n        entityId: entity.id,\n        name: COMPONENT_NAMESPACE,\n        state: { collisions: state.collisions || [], collisionGroup: state.collisionGroup },\n        update: (system: ISystemManager, component: ICollidableEntity) => {\n          handleCollisions(entity, component, system, events);\n        },\n      }))\n  }\n}\n\ntype ICollidableEntity = IComponent<WithCollisions & WithGeometry & WithPosition>\n\nfunction handleCollisions(entity: IEntity, component: ICollidableEntity, system: ISystemManager, events: IComponentEvents) {\n  const position = system.getEntityModel<WithGeometry & WithPosition>({ id: component.entityId });\n\n  const collidableEntities = system\n    .getEntitiesByComponentTypes(['geometry', 'position', 'collidable'])\n    .filter(id => id !== component.entityId)\n    .map(id => system.getEntityModel<IsCollidable & WithGeometry & WithPosition>({ id }))\n    .filter(model => model.collisionGroup !== component.state.collisionGroup);\n\n  const ownBounds = getBounds(position.position, position.geometry);\n\n  const collisions: EntityIdType[] = [];\n\n  collidableEntities.forEach(o => {\n    const otherBounds = getBounds(o.position, o.geometry);\n    if (overlap(ownBounds, otherBounds) && otherBounds !== undefined) {\n      collisions.push(o.id);\n    }\n  });\n\n  const lastCollisions = component.state.collisions\n    ? component.state.collisions.map(o => o)\n    : [];\n\n  component.state.collisions = collisions;\n\n  if (diff(lastCollisions, collisions) && collisions.length > 0) {\n    events.onChange(ON_COLLISION, component, entity);\n  }\n}\n\nexport const selectCollidableState = createSelector<ICollidableEntity>(COMPONENT_NAMESPACE);\nexport const setCollidableState    = createSetter<ICollidableEntity>(selectCollidableState);\n\nfunction getBounds(pos: IVector, dimensions: IDimensions) {\n  return {\n    left: pos.x - (dimensions.width / 2),\n    right: pos.x + (dimensions.width / 2),\n    top: pos.y,\n    bottom: pos.y + dimensions.height,\n  }\n}\n\nfunction overlap(a: Bounds, b: Bounds) {\n  // If one rectangle is on left side of other\n  if (a.left > b.right || b.left > a.right)\n    return false;\n\n  // If one rectangle is above other\n  if (a.bottom < b.top || b.bottom < a.top)\n    return false;\n\n  return true;\n}\n\nfunction diff(arrayToCompareTo: number[], comparedArray: number[])\n{\n  const sorted1 = arrayToCompareTo.sort();\n  const sorted2 = comparedArray.sort();\n\n  if (sorted2.length > sorted1.length) {\n    return true;\n  }\n\n  for(var i = 0; i < sorted1.length; ++i) {\n    if (sorted1[i] != sorted2[i]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import { createCharacter } from \"../Domain/character\";\nimport { ISystemManager } from \"../../engine/types\";\nimport { defaultBoundary } from \"../../engine/utils\";\nimport { SpriteTextureIds } from \"../catalogue\";\n\nexport function createPlayer(\n  system:           ISystemManager,\n  name:             string = 'player 1',\n  collisionGroup:   string = 'friendly',\n) {\n\n  const playerEntity = createCharacter(system, {\n    name,\n\n    texture: SpriteTextureIds.Player,\n\n    health: {\n      value: 100,\n      immortal: false,\n    },\n\n    attackPower: 10,\n\n    speed: {\n      y: 0,\n      x: 6,\n    },\n  \n    position: {\n      x: 400,\n      y: 475,\n    },\n\n    homePosition: {\n      x: 400,\n      y: 475,\n    },\n  \n    direction: {\n      x: 0,\n      y: 0,\n    },\n  \n    geometry: {\n      width:  64,\n      height: 64,\n    },\n  \n    moving: false,\n  \n    attacking: false,\n\n    boundary: defaultBoundary,\n\n    collisionGroup,\n  });\n\n  return playerEntity;\n}\n","import { IEntity, ISystemManager } from \"../../engine/types\";\nimport { combatableFactory,         WithAttack } from \"../../engine/components/combatable\";\nimport { nameableFactory,           WithName } from \"../../engine/components/nameable\";\nimport { killableFactory,           WithHealth, WithHealthState } from \"../../engine/components/killable\";\nimport { withPositionFactory,       WithPosition, WithPositionState } from \"../../engine/components/withPosition\";\nimport { withGeometryFactory,       WithGeometry } from \"../../engine/components/withGeometry\";\nimport { withBoundaryFactory,       WithBoundary } from \"../../engine/components/withBoundary\";\nimport { withTextureFactory,        WithTexture } from \"../../engine/components/withTexture\";\nimport { withPlayerControlsFactory, WithControls } from \"../../engine/components/withPlayerControls\";\nimport { isCollidableFactory,       IsCollidable } from \"../../engine/components/isCollidable\";\nimport { withCollisionsFactory } from \"../../engine/components/withCollisions\";\nimport { withHomePositionFactory, WithHomePosition } from \"../../engine/components/withHomePosition\";\n\nexport function createCharacter(\n  system:   ISystemManager,\n  options:  CharacterModelArgs,\n): IEntity {\n  const withName          = nameableFactory(system);\n  const withHealth        = killableFactory(system);\n  const withPosition      = withPositionFactory(system);\n  const withControls      = withPlayerControlsFactory(system);\n  const withAttack        = combatableFactory(system);\n  const withGeometry      = withGeometryFactory(system);\n  const withTexture       = withTextureFactory(system);\n  const isCollidable      = isCollidableFactory(system);\n  const withCollisions    = withCollisionsFactory(system);\n  const withBoundary      = withBoundaryFactory(system);\n  const withHomePosition  = withHomePositionFactory(system);\n\n  const entity = system.registerEntity();\n\n  system.registerComponent(\n    withName(entity, options, system.events)\n  );\n  system.registerComponent(\n    withHealth(entity, options, system.events)\n  );\n  system.registerComponent(\n    withPosition(entity, options, system.events)\n  );\n  system.registerComponent(\n    withHomePosition(entity, options, system.events)\n  );\n  system.registerComponent(\n    withGeometry(entity, options, system.events)\n  );\n  system.registerComponent(\n    withTexture(entity, options, system.events)\n  );\n  system.registerComponent(\n    withAttack(entity, options, system.events)\n  );\n  system.registerComponent(\n    isCollidable(entity, options, system.events)\n  );\n  system.registerComponent(\n    withCollisions(entity, options, system.events)\n  );\n  system.registerComponent(\n    withBoundary(entity, options, system.events)\n  );\n  system.registerComponent(\n    withControls(entity, {\n      direction: options.direction,\n      moving: options.moving,\n      speed: options.speed,\n    }, system.events)\n  );\n  return entity;\n}\n\nexport type CharacterModelArgs =\n  WithName          &\n  WithHealth        &\n  WithPosition      &\n  WithGeometry      &\n  WithTexture       &\n  WithAttack        &\n  WithBoundary      &\n  IsCollidable      &\n  WithHomePosition  &\n  WithControls;\n\nexport type CharacterModel =\n  WithName          &\n  WithHealthState   &\n  WithPositionState &\n  WithGeometry      &\n  WithTexture       &\n  WithAttack        &\n  WithBoundary      &\n  IsCollidable      &\n  WithHomePosition  &\n  WithControls;\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { WithPosition } from \"./withPosition\";\nimport { factory, createSelector, createSetter } from \"../utils\";\nimport { WithOffscreen } from \"./withOffscreen\";\n\nconst COMPONENT_NAMESPACE = 'momentum';\n\nexport type WithMomentum = { momentum: { direction: IVector; speed: number; vertical?: boolean; horizontal?: boolean; } };\n\nexport function withMomentumFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithMomentum, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithMomentum>>({\n        id,\n        entityId: entity.id,\n        name:     COMPONENT_NAMESPACE,\n        state: { momentum: {\n          direction:    state.momentum.direction,\n          speed:        state.momentum.speed,\n        } },\n        update: (system: ISystemManager, component: IWithMomentumEntity) => {\n          handleMovement(entity, component, system);\n        },\n      }))\n  }\n}\n\ntype IWithMomentumEntity = IComponent<WithMomentum & Partial<WithPosition>>\n\nfunction handleMovement(entity: IEntity, component: IWithMomentumEntity, system: ISystemManager) {\n  const {state: { position }} = system.getEntityComponent<WithPosition>(entity, 'position');\n  const {state: { offscreen }} = system.getEntityComponent<WithOffscreen>(entity, 'offscreen');\n\n  if (offscreen) {\n    return;\n  }\n\n  const { momentum: { direction, speed } } = component.state;\n\n  position.y += direction.y * speed;\n  position.x += direction.x * speed;\n}\n\nexport const selectMomentumState = createSelector<WithMomentum>(COMPONENT_NAMESPACE);\nexport const setMomentumState    = createSetter<WithMomentum>(selectMomentumState);\n","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { WithPosition } from \"./withPosition\";\nimport { factory } from \"../utils\";\n\nexport type WithOffscreen = { offscreen?: boolean; };\n\nexport function withOffscreenFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithOffscreen & Partial<WithPosition>, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithOffscreen>>({\n        id,\n        entityId: entity.id,\n        name: 'offscreen',\n        state: { offscreen: state.offscreen || false },\n        update: (system: ISystemManager, component: IWithOffscreenEntity) => {\n          handleOffscreenFlag(entity, component, system);\n        },\n      }))\n  }\n}\n\ntype IWithOffscreenEntity = IComponent<WithOffscreen & WithPosition>\n\nfunction handleOffscreenFlag(entity: IEntity, component: IWithOffscreenEntity, system: ISystemManager) {\n  const {state: { position }} = system.getEntityComponent<WithPosition>(entity, 'position');\n  const {screenSize} = system.config;\n\n  if (position.x < 0 || position.y < 0) {\n    component.state.offscreen = true;\n    return;\n  }\n\n  if (position.x > screenSize!.x || position.y > screenSize!.y) {\n    component.state.offscreen = true;\n    return;\n  } \n  \n  if (position.x > window.innerWidth || position.y > window.innerHeight) {\n    component.state.offscreen = true;\n    return;\n  }\n\n  component.state.offscreen = false;\n};\n","import { ISystemManager } from \"../../engine/types\";\nimport { createProjectile } from \"../Domain/projectile\";\n\nexport function createBullet(\n  system: ISystemManager,\n  name: string,\n  x: number = -100,\n  speed: number = 8,\n  collisionGroup: string = 'friendly',\n) {\n\n  const entity = createProjectile(system, {\n    name,\n\n    momentum: {\n      direction: {\n        x: 0,\n        y: -1,\n      },\n      speed,\n    },\n\n    position: {\n      x: x,\n      y: 440,\n    },\n\n    geometry: {\n      width:  2,\n      height: 32,\n    },\n\n    collisionGroup,\n  });\n\n  return entity;\n}\n","import { IEntity, ISystemManager, IComponent } from \"../../engine/types\";\nimport { withPositionFactory,     WithPosition, WithPositionState } from \"../../engine/components/withPosition\";\nimport { withMomentumFactory,     WithMomentum } from \"../../engine/components/withMomentum\";\nimport { withOffscreenFactory,    WithOffscreen } from \"../../engine/components/withOffscreen\";\nimport { withGeometryFactory,     WithGeometry } from \"../../engine/components/withGeometry\";\nimport { withCollisionsFactory,   WithCollisionArgs, WithCollisions } from \"../../engine/components/withCollisions\";\nimport { nameableFactory,         WithName } from \"../../engine/components/nameable\";\n\n\nexport function createProjectile(\n  system:   ISystemManager,\n  options:  ProjectileBaseArgs,\n): IEntity {\n  const withName        = nameableFactory(system);\n  const withPosition    = withPositionFactory(system);\n  const withMomentum    = withMomentumFactory(system);\n  const withOffscreen   = withOffscreenFactory(system);\n  const withGeometry    = withGeometryFactory(system);\n  const withCollisions  = withCollisionsFactory(system);\n\n  const entity = system.registerEntity();\n\n  system.registerComponent(\n    withName(entity, options, system.events)\n  );\n  system.registerComponent(\n    withPosition(entity, options, system.events)\n  );\n  system.registerComponent(\n    withGeometry(entity, options, system.events)\n  );\n  system.registerComponent(\n    withMomentum(entity, options, system.events)\n  );\n  system.registerComponent(\n    withCollisions(entity, options, system.events)\n  );\n  system.registerComponent(\n    withOffscreen(entity, options, system.events)\n  );\n  return entity;\n}\n\nexport type ProjectileBaseArgs =\n  WithPosition        &\n  WithMomentum        &\n  WithGeometry        &\n  WithCollisionArgs   &\n  WithName            &\n  WithOffscreen;\n\nexport type ProjectileBase =\n  WithPosition        &\n  WithMomentum        &\n  WithGeometry        &\n  WithCollisions      &\n  WithName            &\n  WithOffscreen;\n\nexport type ProjectileModel = \n  IComponent &\n  ProjectileBase;\n","import {Howl, Howler} from 'howler';\nimport { IBasicConfig, IAudioManager, IAudioCollection } from \"../types\";\n\nconst configDefaults = {\n  name: 'AudioManager',\n  debug: true,\n  logging: true,\n  version: '1',\n}\n\nclass AudioManager implements IAudioManager {\n  public config:            IBasicConfig;\n  public sounds:            IAudioCollection;\n  public songs:             IAudioCollection;\n\n  private soundFactory:     HowlStatic;\n  private audioEngine:      HowlerGlobal;\n\n  constructor(config: IBasicConfig) {\n    this.config       = { ...configDefaults, ...config };\n    this.sounds       = {};\n    this.songs        = {};\n\n    this.soundFactory = Howl;\n    this.audioEngine  = Howler;\n  }\n\n  public init = (config?: IBasicConfig) => null;\n\n  public registerSound(name: string, options: IHowlProperties) {\n    this.sounds[name] = new this.soundFactory(options);\n  }\n\n  public unRegisterSound(name: string) {\n    this.sounds[name].stop();\n    this.sounds[name].unload();\n    delete this.sounds[name];\n  }\n\n  public registerSong(name: string, options: IHowlProperties) {\n    this.songs[name] = new this.soundFactory({\n      loop: true,\n      ...options\n    });\n  }\n\n  public unRegisterSong(name: string) {\n    this.songs[name].stop();\n    this.songs[name].unload();\n    delete this.songs[name];\n  }\n\n  public playSound(name: string, sprite?: string | number) {\n    // try {\n    //   this.sounds[name].play(sprite);\n    // } catch (e) {\n    //   throw new Error(`[AudioManager:ERROR]: Sound: \"${name}\" not found..`)\n    // }\n  }\n\n  public stopSound(name: string, id?: number) {\n    try {\n      this.sounds[name].stop(id)\n    } catch (e) {\n      throw new Error(`[AudioManager:ERROR]: Sound: \"${name}\" not found..`)\n    }\n  }\n\n  public playSong(name: string, sprite?: string | number) {\n    // try {\n    //   this.songs[name].play(sprite);\n    // } catch (e) {\n    //   throw new Error(`[AudioManager:ERROR]: Song: \"${name}\" not found..`)\n    // }\n  }\n\n  public stopSong(name: string, id?: number) {\n    try {\n      this.songs[name].stop(id);\n    } catch (e) {\n      throw new Error(`[AudioManager:ERROR]: Song: \"${name}\" not found..`)\n    }\n  }\n\n  public registerListener(name: string, event: string, callback: (soundId: number) => void) {\n    this.sounds[name].on(event, callback);\n  }\n\n  public registerOnceListener(name: string, event: string, callback: (soundId: number) => void) {\n    this.sounds[name].once(event, callback);\n  }\n\n  public unRegisterListener(name: string, event: string, callback: (soundId: number) => void) {\n    this.sounds[name].off(event, callback);\n  }\n\n  public changeVolume(volume: number): void {\n    this.audioEngine.volume(volume);\n  }\n\n  public toString = (): string => {\n    return JSON.stringify({\n      config:   this.config,\n    }, null, '  ')\n  };\n}\n\nexport default AudioManager;\n","import { IComponent, IdGeneratorFunc, EntityIdType, IBasicConfig } from \"../types\";\nimport { defaultIdGenerator, factory } from \"../utils\";\n\nconst configDefaults = {\n  name: 'componentManager',\n  debug: true,\n  logging: true,\n  version: '1',\n}\n\nclass ComponentManager {\n  public config:             IBasicConfig;\n\n  public components:         IComponent[];\n  private idGenerator:       IdGeneratorFunc;\n\n  constructor(config: IBasicConfig) {\n    this.config      = { ...configDefaults, ...config };\n    this.components  = [];\n    this.idGenerator = defaultIdGenerator();\n  }\n\n  public init = (config?: IBasicConfig) => null;\n\n  public registerComponent = <T>(component: IComponent<T>) => {\n    component.id = (component.id === -1)\n      ? this.idGenerator().next()\n      : component.id;\n\n    const model = factory<IComponent>(component);\n    this.components[component.id] = model;\n    return model;\n  };\n\n  public unRegisterComponent = (componentId: EntityIdType) => {\n    delete this.components[componentId];\n  };\n\n  public get = <T>(component: IComponent<T> | number) => {\n    const path = typeof component === 'number' ? component : component && component.id;\n    return this.components[path];\n  };\n\n  public get getState(): IComponent[] {\n    return this.components;\n  };\n\n  public getSerializableState = () => {\n    const { config, components } = this;\n    return {\n      config,\n      components,\n    };\n  };\n\n  public loadHydratedState = (state: any) => {\n    this.config     = state.config;\n    this.components = state.components;\n  };\n\n  public toString = () => {\n    return JSON.stringify({\n      config:     this.config,\n      components: this.components,\n    }, null, '  ')\n  };\n\n  static isSameComponent(a: IComponent, b: IComponent) {\n    return a.id === b.id;\n  }\n}\n\nexport default ComponentManager;\n\n// const manager = new ComponentManager(system.system, configDefaults, [], defaultIdGenerator());\n","import { EntityIdType, IEntity, IdGeneratorFunc, IBasicConfig } from \"../types\";\nimport { defaultIdGenerator, factory } from \"../utils\";\n\ninterface IEntityManagerSerializableState {\n  config:   IBasicConfig,\n  entities: IEntity[],\n}\n\nconst configDefaults = {\n  name: 'EntityManager',\n  debug: true,\n  logging: true,\n  version: '1',\n}\n\nclass EntityManager {\n  public config:              IBasicConfig;\n  public entities:           IEntity[];\n  private idGenerator:        IdGeneratorFunc;\n  constructor(config: IBasicConfig) {\n    this.config      = { ...configDefaults, ...config };\n    this.entities    = [];\n    this.idGenerator = defaultIdGenerator();\n  }\n\n  public init = (config?: IBasicConfig) => null;\n\n  public registerEntity = (): IEntity => {\n    const entityId = this.idGenerator().next()\n    const model    = factory<IEntity>({ id: entityId });\n    this.entities[entityId] = model;\n    return model;\n  };\n\n  public unRegisterEntity = (entityId: EntityIdType): void => {\n    delete this.entities[entityId];\n  };\n\n  public get = (entity: IEntity | number) => {\n    const path = typeof entity === 'number' ? entity : entity.id;\n    return this.entities[path];\n  };\n\n  public get getState(): IEntity[] {\n    return this.entities;\n  };\n\n  public getSerializableState = (): IEntityManagerSerializableState => {\n    const { config, entities } = this;\n    return {\n      config,\n      entities,\n    };\n  };\n\n  public loadHydratedState = (state: IEntityManagerSerializableState): void => {\n    this.config  = state.config;\n    this.entities = state.entities;\n  };\n\n  public toString = (): string => {\n    return JSON.stringify({\n      config:   this.config,\n      entities: this.entities,\n    }, null, '  ')\n  };\n\n  static isSameEntity(a: IEntity, b: IEntity): boolean {\n    return a.id === b.id;\n  }\n}\n\nexport default EntityManager;\n","import { IBasicConfig, IComponentEvents, IOnUpdateHandler, IOnChangeHandler, IComponent, IEventManager, AnonymousCB, IEntity } from \"../types\";\nimport {EventEmitter2} from 'eventemitter2';\n\nconst configDefaults = {\n  name: 'EventManager',\n  debug: true,\n  logging: true,\n  version: '1',\n}\n\nclass EventManager implements IEventManager {\n  public config:        IBasicConfig;\n  public emitter:       EventEmitter2;\n \n  constructor(config: IBasicConfig) {\n    this.config      = { ...configDefaults, ...config };\n    this.emitter     = new EventEmitter2({\n      delimiter:  ':',\n      wildcard:   true,\n      maxListeners: 20,\n    });\n  }\n\n  public init = (config?: IBasicConfig) => null;\n\n  public registerListener = (name: string, callback: AnonymousCB) => {\n    this.emitter.addListener(name, callback)\n  };\n\n  public unRegisterListener = (name: string, callback: AnonymousCB): void => {\n    this.emitter.removeListener(name, callback);\n  };\n\n  public emit = <T>(eventName: string, data?: T) => {\n    this._emit(eventName, data);\n  };\n\n  public onUpdate = (component: IComponent, entity: IEntity) => {\n    this._emit('updateComponent', component, entity);\n  };\n\n  public onChange = (eventName: string, component: IComponent, entity: IEntity): void => {\n    this._emit(eventName, component, entity);\n  };\n\n  private _emit = (event: string, ...args: any[]) => {\n    if (this.config.logging) {\n      console.log(`[EventService]: Event: \"${event}\"; args:`, args)\n    }\n    this.emitter.emit(event, ...args);\n  }\n}\n\nexport default EventManager;\n","\nexport function Vector2(x, y)\n{\n\tthis.x = (x !== undefined) ? x : 0;\n\tthis.y = (y !== undefined) ? y : 0;\n}\n\nVector2.prototype.set = function(x, y)\n{\n\tthis.x = x;\n\tthis.y = y;\n}\n","import {Vector2} from './Vector2';\nimport {Key} from './Key';\n\nexport function Mouse()\n{\n\t//Raw data\n\tthis._keys = [];\n\tthis._position = new Vector2(0, 0);\n\tthis._positionUpdated = false;\n\tthis._delta = new Vector2(0, 0);\n\tthis._wheel = 0;\n\tthis._wheelUpdated = false;\n\tthis._doubleClicked = false;\n\n\t//Position, delta, and scroll speed\n\tthis.keys = [];\n\tthis.position = new Vector2(0,0);\n\tthis.delta = new Vector2(0,0);\n\tthis.wheel = 0;\n\tthis.doubleClicked = false;\n\n\t//Canvas (use to calculate coordinates relative to it)\n\tthis.canvas = null;\n\t\n\t//Events\n\tthis.events = [];\n\n\t//Initialize key instances\n\tfor(let i = 0; i < 3; i++)\n\t{\n\t\tthis._keys.push(new Key());\n\t\tthis.keys.push(new Key());\n\t}\n\n\t//Self pointer\n\tlet self = this;\n\n\t//Scroll wheel\n\tif(window.onmousewheel !== undefined)\n\t{\n\t\t//Chrome, edge\n\t\tthis.events.push([window, \"mousewheel\", function(event)\n\t\t{\n\t\t\tself._wheel = event.deltaY;\n\t\t\tself._wheelUpdated = true;\n\t\t}]);\n\t}\n\telse if(window.addEventListener !== undefined)\n\t{\n\t\t//Firefox\n\t\tthis.events.push([window, \"DOMMouseScroll\", function(event)\n\t\t{\n\t\t\tself._wheel = event.detail * 30;\n\t\t\tself._wheelUpdated = true;\n\t\t}]);\n\t}\n\telse\n\t{\n\t\tthis.events.push([window, \"wheel\", function(event)\n\t\t{\n\t\t\tself._wheel = event.deltaY;\n\t\t\tself._wheelUpdated = true;\n\t\t}]);\n\t}\n\n\t//Touchscreen input\n\tif(\"ontouchstart\" in window || navigator.msMaxTouchPoints > 0)\n\t{\n\t\t//Auxiliar variables to calculate touch delta\n\t\tvar lastTouch = new Vector2(0, 0);\n\n\t\t//Touch screen pressed event\n\t\tthis.events.push([window, \"touchstart\", function(event)\n\t\t{\n\t\t\tvar touch = event.touches[0];\n\t\t\tlastTouch.set(touch.clientX, touch.clientY);\n\t\t\tself.updateKey(Mouse.LEFT, Key.DOWN);\n\t\t}]);\n\n\t\t//Touch screen released event\n\t\tthis.events.push([window, \"touchend\", function(event)\n\t\t{\n\t\t\tself.updateKey(Mouse.LEFT, Key.UP);\n\t\t}]);\n\n\t\t//Touch screen move event\n\t\tthis.events.push([window, \"touchmove\", function(event)\n\t\t{\n\t\t\tvar touch = event.touches[0];\n\n\t\t\tif(self.canvas !== null)\n\t\t\t{\n\t\t\t\tvar rect = self.canvas.getBoundingClientRect();\n\t\t\t\tself.updatePosition(touch.clientX - rect.left, touch.clientY - rect.top, touch.clientX - lastTouch.x, touch.clientY - lastTouch.y);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tself.updatePosition(touch.clientX, touch.clientY, touch.clientX - lastTouch.x, touch.clientY - lastTouch.y);\n\t\t\t}\n\n\t\t\tlastTouch.set(touch.clientX, touch.clientY);\n\t\t}]);\n\t}\n\t//Input\n\telse\n\t{\n\t\t//Move event\n\t\tthis.events.push([window, \"mousemove\", function(event)\n\t\t{\n\t\t\tif(self.canvas !== null)\n\t\t\t{\n\t\t\t\tvar rect = self.canvas.getBoundingClientRect();\n\t\t\t\tself.updatePosition(event.clientX - rect.left, event.clientY - rect.top, event.movementX, event.movementY);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tself.updatePosition(event.clientX, event.clientY, event.movementX, event.movementY);\n\t\t\t}\n\t\t}]);\n\n\t\t//Button pressed event\n\t\tthis.events.push([window, \"mousedown\", function(event)\n\t\t{\n\t\t\tself.updateKey(event.which - 1, Key.DOWN);\n\t\t}]);\n\n\t\t//Button released event\n\t\tthis.events.push([window, \"mouseup\", function(event)\n\t\t{\n\t\t\tself.updateKey(event.which - 1, Key.UP);\n\t\t}]);\n\t}\n\n\t//Mouse double click\n\tthis.events.push([window, \"dblclick\", function(event)\n\t{\n\t\tself._doubleClicked = true;\n\t}]);\n\n\t//Initialize events\n\tfor(let i = 0; i < this.events.length; i++)\n\t{\n\t\tvar event = this.events[i];\n\t\tevent[0].addEventListener(event[1], event[2]);\n\t}\n}\n\n//Mouse Buttons\nMouse.LEFT = 0;\nMouse.MIDDLE = 1;\nMouse.RIGHT = 2;\n\n//Canvas to be used for relative coordinates calculation\nMouse.prototype.setCanvas = function(canvas)\n{\n\tthis.canvas = canvas;\n\n\tcanvas.mouseInside = false;\n\n\tcanvas.addEventListener(\"mouseenter\", function()\n\t{\n\t\tthis.mouseInside = true;\n\t});\n\n\tcanvas.addEventListener(\"mouseleave\", function()\n\t{\n\t\tthis.mouseInside = false;\n\t});\n}\n\n//Check if mouse is inside attached canvas\nMouse.prototype.insideCanvas = function()\n{\n\tif(this.canvas === null)\n\t{\n\t\treturn false;\n\t}\n\t\n\treturn this.canvas.mouseInside;\n}\n\n//Set if mouse locked\nMouse.prototype.setLock = function(value)\n{\n\tif(this.canvas !== null)\n\t{\n\t\tif(value)\n\t\t{\n\t\t\tif(this.canvas.requestPointerLock)\n\t\t\t{\n\t\t\t\tthis.canvas.requestPointerLock();\n\t\t\t}\n\t\t\telse if(this.canvas.mozRequestPointerLock)\n\t\t\t{\n\t\t\t\tthis.canvas.mozRequestPointerLock();\n\t\t\t}\n\t\t\telse if(this.canvas.webkitRequestPointerLock)\n\t\t\t{\n\t\t\t\tthis.canvas.webkitRequestPointerLock();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(document.exitPointerLock)\n\t\t\t{\n\t\t\t\tdocument.exitPointerLock();\n\t\t\t}\n\t\t\telse if(document.mozExitPointerLock)\n\t\t\t{\n\t\t\t\tdocument.mozExitPointerLock();\n\t\t\t}\n\t\t\telse if(document.webkitExitPointerLock)\n\t\t\t{\n\t\t\t\tdocument.webkitExitPointerLock();\n\t\t\t}\n\t\t}\n\t}\n}\n\n//Check if mouse button is pressed\nMouse.prototype.buttonPressed = function(button)\n{\n\treturn this.keys[button].pressed;\n}\n\n//Check if Mouse button was double clicked\nMouse.prototype.buttonDoubleClicked = function()\n{\n\treturn this.doubleClicked;\n}\n\n//Check if a mouse button was just pressed\nMouse.prototype.buttonJustPressed = function(button)\n{\n\treturn this.keys[button].justPressed;\n}\n\n//Check if a mouse button was just released\nMouse.prototype.buttonJustReleased = function(button)\n{\n\treturn this.keys[button].justReleased;\n}\n\n//Update mouse Position\nMouse.prototype.updatePosition = function(x, y, xDiff, yDiff)\n{\n\tthis._position.set(x, y);\n\tthis._delta.x += xDiff;\n\tthis._delta.y += yDiff;\n\tthis._positionUpdated = true;\n}\n\n//Update mouse Key\nMouse.prototype.updateKey = function(button, action)\n{\n\tif(button > -1)\n\t{\n\t\tthis._keys[button].update(action);\n\t}\n}\n\n//Update mouse State (Calculate position diff)\nMouse.prototype.update = function()\n{\n\t//Update mouse keys state\n\tfor(let i = 0; i < this._keys.length; i++)\n\t{\n\t\tif(this._keys[i].justPressed && this.keys[i].justPressed)\n\t\t{\n\t\t\tthis._keys[i].justPressed = false;\n\t\t}\n\t\tif(this._keys[i].justReleased && this.keys[i].justReleased)\n\t\t{\n\t\t\tthis._keys[i].justReleased = false;\n\t\t}\n\t\tthis.keys[i].set(this._keys[i].justPressed, this._keys[i].pressed, this._keys[i].justReleased);\n\t}\n\n\t//Update mouse wheel\n\tif(this._wheelUpdated)\n\t{\n\t\tthis.wheel = this._wheel;\n\t\tthis._wheelUpdated = false;\n\t}\n\telse\n\t{\n\t\tthis.wheel = 0;\n\t}\n\n\t//Update mouse double click\n\tif(this._doubleClicked)\n\t{\n\t\tthis.doubleClicked = true;\n\t\tthis._doubleClicked = false;\n\t}\n\telse\n\t{\n\t\tthis.doubleClicked = false;\n\t}\n\n\t//Update mouse Position if needed\n\tif(this._positionUpdated)\n\t{\n\t\tthis.delta.x = this._delta.x;\n\t\tthis.delta.y = this._delta.y;\n\t\tthis._delta.set(0,0);\n\n\t\tthis.position.x = this._position.x;\n\t\tthis.position.y = this._position.y;\n\n\t\tthis._positionUpdated = false;\n\t}\n\telse\n\t{\n\t\tthis.delta.x = 0;\n\t\tthis.delta.y = 0;\n\t}\n}\n\n//Dispose mouse object\nMouse.prototype.dispose = function()\n{\n\tfor(let i = 0; i < this.events.length; i++)\n\t{\n\t\tvar event = this.events[i];\n\t\tevent[0].removeEventListener(event[1], event[2]);\n\t}\n}\n","import { IInputManager, IMouse, IKeyboard} from '../types';\nimport { Mouse } from \"../../extern/Mouse\";\nimport { Keyboard } from \"../../extern/Keyboard\";\n\nclass InputManager implements IInputManager {\n  public KeyCodes: Keyboard = Keyboard;\n  constructor(\n    private mouse: IMouse = new Mouse(),\n    private keyboard: IKeyboard = new Keyboard(),\n  ) {}\n  \n  public buttonPressed = (button: number) => this.mouse.buttonPressed(button);\n\n  public keyPressed = (key: number) => this.keyboard.keyPressed(key);\n  public keyJustPressed = (key: number) => this.keyboard.keyJustPressed(key);\n  public keyJustReleased = (key: number) => this.keyboard.keyJustReleased(key);\n\n  update = () => {\n    this.mouse.update();\n    this.keyboard.update();\n  };\n}\n\nexport default InputManager;\n","import { ISerializableState, IComponent, ISystemManager, IComponentFactoryInitializer, IStorageManager, IComponentFactory } from \"../types\";\nimport { defaultComponentEvents } from \"../utils\";\n\nclass StorageManager implements IStorageManager {\n  constructor( \n    private system: ISystemManager,\n  ) {}\n\n  public saveGame = () => {\n    this.saveState('ecs', this.system.getSerializableState());\n  }\n  \n  public loadGame = () => {\n    const loadedFromStorage = this.loadStateFromKey('ecs');\n  \n    if (loadedFromStorage) {\n      const hydratedComponents = this.hydrateLoadedComponents(this.system, loadedFromStorage);\n      loadedFromStorage.system.components = hydratedComponents;\n  \n      this.system.loadHydratedState(loadedFromStorage);\n    }\n  }\n  \n  private saveState<T extends ISerializableState>(key: string, value: T): void {\n    const serialized = JSON.stringify(value);\n    window.localStorage.setItem(key, serialized);\n  }\n  \n  private loadStateFromKey(key: string): ISerializableState | null {\n    const serialized = window.localStorage.getItem(key);\n  \n    if (!serialized) {\n      return null;\n    }\n  \n    return JSON.parse(serialized) as ISerializableState;\n  }\n  \n  private hydrateLoadedComponents(system: ISystemManager, state: ISerializableState): IComponent[] {\n    const { system: { components } } = state;\n  \n    const componentInitializerCache: { [key: string]: IComponentFactoryInitializer } = {};\n  \n    return components.map((component: IComponent) => {\n      const cached = componentInitializerCache[component.name];\n  \n      let componentInitializer: IComponentFactoryInitializer;\n  \n      if (cached) {\n        componentInitializer = cached;\n      } else {\n        componentInitializer = this.system.getComponentFactory(component.name)(system);\n        componentInitializerCache[component.name] = componentInitializer;\n      }\n  \n      const entity = { id: component.entityId }\n      return componentInitializer(entity, component.state, defaultComponentEvents(), component.id); // !!! HACK FIX ME TODO ACHTUNG\n    });\n  }\n}\n\nexport default StorageManager;\n","import { IComponent, ISystemManager, IVector, IEntity, IComponentEvents } from \"../types\";\nimport { WithPosition } from \"./withPosition\";\nimport { factory } from \"../utils\";\nimport { WithBoundary } from \"./withBoundary\";\n\nexport type WithControls = { direction: IVector; moving: boolean; speed: IVector; };\n\nexport function controllableFactory(system: ISystemManager) {\n  return (entity: IEntity, state: WithControls, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithControls>>({\n        id,\n        entityId: entity.id,\n        name: 'controls',\n        state: {\n          direction: state.direction,\n          moving: state.moving,\n          speed: state.speed,\n        },\n        update: (system: ISystemManager, component: IControllableEntity) => {\n          handleVerticalMovement(entity, component, system);\n          handleHorizontalMovement(entity, component, system);\n          \n          handleMovingFlag(entity, component, system);\n        },\n      }))\n  }\n}\n\ntype IControllableEntity = IComponent<WithControls & Partial<WithPosition> & Partial<WithBoundary>>\n\nfunction handleVerticalMovement(entity: IEntity, component: IControllableEntity, system: ISystemManager) {\n  handleMovement(entity, component, system, 'vertical');\n}\n\nfunction handleHorizontalMovement(entity: IEntity, component: IControllableEntity, system: ISystemManager) {\n  handleMovement(entity, component, system);\n}\n\nfunction handleMovement(entity: IEntity, component: IControllableEntity, system: ISystemManager, direction: 'vertical' | 'horizontal' = 'horizontal') {\n\n  const key = direction === 'horizontal' ? 'x' : 'y';\n  const [neg, pos] = direction === 'horizontal'\n    ? [system.input.KeyCodes.LEFT, system.input.KeyCodes.RIGHT]\n    : [system.input.KeyCodes.UP,   system.input.KeyCodes.DOWN];\n\n  if (system.input.keyPressed(pos)) {\n    component.state.direction[key] = 1;\n  } else\n  if (system.input.keyPressed(neg)) {\n    component.state.direction[key] = -1;\n  } else {\n    component.state.direction[key] = 0;\n  }\n}\n\nfunction handleMovingFlag(entity: IEntity, component: IControllableEntity, system: ISystemManager) {\n  const {x, y} = component.state.direction;\n  if (x === 0 && y === 0) {\n    component.state.moving = false;\n  } else {\n    component.state.moving = true;\n  }\n}\n","import { IComponentFactories, IComponentFactoryKey } from \"../types\";\nimport { ageableFactory } from \"./ageable\";\nimport { controllableFactory } from \"./controllable__OLD\";\nimport { combatableFactory } from \"./combatable\";\nimport { killableFactory } from \"./killable\";\nimport { withPositionFactory } from \"./withPosition\";\nimport { nameableFactory } from \"./nameable\";\nimport { isCollidableFactory } from \"./isCollidable\";\nimport { withCollisionsFactory } from \"./withCollisions\";\nimport { withGeometryFactory } from \"./withGeometry\";\nimport { withMomentumFactory } from \"./withMomentum\";\nimport { withOffscreenFactory } from \"./withOffscreen\";\nimport { lootableFactory } from \"./lootable\";\nimport { withBoundaryFactory } from \"./withBoundary\";\nimport { withTextureFactory } from \"./withTexture\";\nimport { withBugWiggleFactory } from \"./withBugWiggle\";\nimport { withHomePositionFactory } from \"./withHomePosition\";\nimport { withWrapAroundPositionFactory } from \"./withWrapAroundPosition\";\n\nexport const defaultComponentFactories: IComponentFactories = {\n  name:         nameableFactory,\n  health:       killableFactory,\n  position:     withPositionFactory,\n  age:          ageableFactory,\n  controls:     controllableFactory,\n  collisions:   withCollisionsFactory,\n  collidable:   isCollidableFactory,\n  attack:       combatableFactory,\n  momentum:     withMomentumFactory,\n  offscreen:    withOffscreenFactory,\n  geometry:     withGeometryFactory,\n  loot:         lootableFactory,\n  boundary:     withBoundaryFactory,\n  texture:      withTextureFactory,\n  wiggle:       withBugWiggleFactory,\n  homePosition: withHomePositionFactory,\n  worldwrap:    withWrapAroundPositionFactory,\n}\n\nexport function getComponentFactory<T extends IComponentFactoryKey>(name: T): IComponentFactories[T] {\n  return  defaultComponentFactories[name];\n}\n  ","import { IComponent, ISystemManager, IEntity, IComponentEvents } from \"../types\";\nimport { factory } from \"../utils\";\n\nexport type WithAge = { age: number };\n\nexport function ageableFactory(system: ISystemManager) {\n  let GAME_YEAR = 2 * 1000;\n  return (entity: IEntity, state: WithAge, events: IComponentEvents, id = -1) => {\n    return system.registerComponent(\n      factory<IComponent<WithAge>>({\n        id,\n        name: 'age',\n        entityId: entity.id,\n        state: { age: state.age },\n        update: (system: ISystemManager, component: IAgeableEntity) => {\n            const {epoch} = system;\n            const remainder = epoch % GAME_YEAR;\n            if (remainder === 0 && epoch > 0) {\n              component.state.age++; \n            }\n        },\n      }))\n  }\n}\n\ntype IAgeableEntity = IComponent<WithAge>;\n","import { IComponent, ISystem, ISystemManager, EntityIdType, IConfigDefaults, IEntity, WithId, IEntityComponents, ISerializableState, IInputManager, IStorageManager, IObjectConfig, IComponentFactory, IComponentFactories, IComponentFactoryKey, IEventManager, IAudioManager } from \"../types\";\nimport AudioManager from \"./AudioManager\";\nimport ComponentManager from \"./ComponentManager\";\nimport EntityManager from \"./EntityManager\";\nimport EventManager from \"./EventManager\";\nimport InputManager from \"./InputManager\";\nimport StorageManager from \"./StorageManager\";\n\nimport { defaultComponentFactories } from \"../components\";\nimport { values, partialSetValue } from \"../utils\";\n\nconst configDefaults: IConfigDefaults = {\n  debug: false,\n  logging: true,\n}\n\nclass SystemManager implements ISystemManager {\n  public system:                ISystem;\n  public config:                IObjectConfig;\n  public input:                 IInputManager;\n  public storage:               IStorageManager;\n  public events:                IEventManager;\n  public audio:                 IAudioManager;\n  public epoch:                 number;\n\n  private entityComponents:     IEntityComponents;\n  private componentFactories:   IComponentFactories;\n  private entityManager:        EntityManager;\n  private componentManager:     ComponentManager;\n\n  private entityModelCache:       { [key: string]: Array<IComponent> } = {};\n  private entityComponentCache:   { [key: string]: number[] } = {};\n  private entityComponentSetter:  (path: (string | number)[], value: any) => void;\n\n  constructor(\n    config:              IObjectConfig,\n    input?:              IInputManager,\n    epochs?:             number,\n  ) {\n    this.config               = { ...configDefaults, ...config };\n    this.input                = input ? input : new InputManager();\n    this.storage              = new StorageManager(this);\n    this.events               = new EventManager(config);\n    this.audio                = new AudioManager(config);\n    this.epoch                = epochs ? epochs : 0;\n    \n    this.componentFactories   = defaultComponentFactories;\n    \n    this.entityManager        = new EntityManager(config);\n    this.componentManager     = new ComponentManager(config);\n    this.entityComponents     = {};\n\n    this.system = {\n      entities:   this.entityManager.entities,\n      components: this.componentManager.components,\n    }\n\n    this.entityComponentSetter = partialSetValue(this.entityComponents);\n  }\n\n  public init = (config?: IObjectConfig) => null;\n\n  public registerEntity = () => {\n    return this.entityManager.registerEntity();\n  };\n\n  public registerComponent = <T>(component: IComponent) => {\n    const registered = this.componentManager\n      .registerComponent<T>(component)\n\n    this.entityComponentSetter(\n      [registered.entityId, registered.name],\n      registered.id,\n    )\n\n    return registered;\n  };\n\n  public getComponent = <T>(component: IComponent): IComponent<T> => {\n    return this.componentManager.get(component);\n  };\n  public getComponentById = <T>(componentId: EntityIdType): IComponent<T> => {\n    return this.componentManager.get(componentId);\n  };\n  public getComponentIdsForEntity = (entity: IEntity): Array<EntityIdType> => {\n    if(entity === undefined) {\n      return [];\n    }\n    return values(this.entityComponents[entity.id]);\n  };\n  public getComponentsForEntity = (entity: IEntity): Array<IComponent> => {\n    return this.getComponentIdsForEntity(entity)\n      .map(this.componentManager.get);\n  };\n  public getComponentFactory = (name: IComponentFactoryKey): IComponentFactory => {\n    return this.componentFactories[name];\n  };\n  private getCachedComponentsForEntity = (entity: IEntity): Array<IComponent> => {\n\n    const cached = this.entityModelCache[entity.id];\n\n    if (cached) {\n      return cached;\n    }\n\n    const entityModels = this.getComponentsForEntity(entity);\n\n    this.entityModelCache[entity.id] = entityModels;\n\n    return entityModels;\n  }\n\n  public unRegisterEntity = (entityId: EntityIdType) => {\n    this.unRegisterComponentsForEntity(entityId);\n    this.deleteEntityComponents(entityId);\n    this.clearEntityComponentCache();\n    this.clearEntityModelCache();\n    this.entityManager.unRegisterEntity(entityId);\n  };\n  public unRegisterComponent = (entityId: EntityIdType) => {\n    this.componentManager.unRegisterComponent(entityId);\n  };\n \n  private unRegisterComponentsForEntity = (entityId: EntityIdType) => {\n    const componentIds = this.getComponentIdsForEntity({ id: entityId });\n    componentIds.forEach(id => this.componentManager.unRegisterComponent(id));\n  };\n  private deleteEntityComponents = (entityId: EntityIdType) => {\n    delete this.entityComponents[entityId];\n  };\n  private clearEntityComponentCache = () => {\n    delete this.entityComponentCache;\n    this.entityComponentCache = {};\n  };\n  private clearEntityModelCache = () => {\n    delete this.entityModelCache;\n    this.entityModelCache = {};\n  };\n\n  public getEntityComponent = <T>(entity: IEntity, componentName: string): IComponent<T> => {\n    return this.getComponentById<T>(this.entityComponents[entity.id][componentName]);\n  }\n  public getEntityModel = <T>(entity: IEntity): WithId<T> => {\n    return groupEntityComponents<T>(entity, this.system.components);\n  };\n  public getEntitiesByComponentTypes = (componentNames: IComponentFactoryKey[]): EntityIdType[] => {\n    const cacheKey = componentNames.join('-');\n\n    if (this.entityComponentCache[cacheKey] !== undefined) {\n      return this.entityComponentCache[cacheKey];\n    }\n\n    const isValidComponent = (component: IComponent) => componentNames.indexOf(component.name) !== -1;\n\n    const entities: EntityIdType[] = [];\n    \n    for (let i = 0; i < this.system.entities.length; i++) {\n      const entity = this.system.entities[i];\n      const components = this.getComponentIdsForEntity(entity)\n        .map(this.getComponentById)\n        .filter(isValidComponent);\n\n      if (components.length === componentNames.length) {\n        entities.push(entity.id);\n      }\n    }\n\n    this.entityComponentCache[cacheKey] = entities;\n\n    return entities;\n  }\n\n  public step = () => {\n    this.input.update();\n    this.updateSystemEntities();\n    this.entityComponentCache = {};\n    this.epoch++;\n    return this.system;\n  };\n  private updateSystemEntities = (): void => {\n    this.system.entities.forEach(this.updateComponentsForEntity);\n  }\n  private updateComponentsForEntity = (entity: IEntity): void => {\n    const components = this.getCachedComponentsForEntity(entity);\n    for (let i = 0; i < components.length; i++) {\n      this.updateComponent(components[i])\n    }\n  }\n  private updateComponent = (o: IComponent) => o.update(this, o);\n\n  public getSerializableState = (): ISerializableState => {\n    const { system, config, epoch, entityComponents } = this;\n    return {\n      system,\n      config,\n      epoch,\n      entityComponents,\n    };\n  };\n  public loadHydratedState = (state: ISerializableState) => {\n    this.system = state.system;\n    this.config = state.config;\n    this.epoch  = state.epoch;\n    this.entityComponents = state.entityComponents;\n  };\n\n  public getState = (): ISystem => {\n    return this.system;\n  };\n\n  public toString = () => {\n    return JSON.stringify({\n      system: this.system,\n      config: this.config,\n    }, null, '  ')\n  };\n}\n\nexport default SystemManager;\n\nfunction groupEntityComponents<T>(entity: IEntity, components: IComponent[]) {\n  return components\n    .filter(o => o && o.entityId === entity.id)\n    .reduce((acc, val) => {\n      return { ...acc, ...val.state };\n    }, { id: entity.id }) as WithId<T>;\n}\n","import { createSystem } from \"./factories/system\";\n\nconst system = createSystem({ name: 'Galaga' })\n\nexport { system };\n","import SystemManager from \"../../engine/services/SystemManager\";\n\ntype SystemArgs = { name: string; version?: string; logging?: boolean; }\n\nexport function createSystem({\n  name,\n  version = '1',\n  logging = true,\n}: SystemArgs) {\n\n  const system = new SystemManager({\n    name,\n    version,\n    logging,\n    screenSize: {\n      x: 800,\n      y: 600,\n    }\n  })\n\n  return system;\n}\n","import * as React from 'react';\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport './App.style.css';\nimport './FontGlow.style.css';\n\nimport { DevScreen } from './client/Development/Dev';\n\nimport { Intro } from './client/Containers/Intro';\nimport { Menu } from './client/Containers/Menu';\nimport { Game } from './client/Containers/Game';\nimport { Outro } from './client/Containers/Outro';\n\nimport { CharacterModel } from './game/Domain/character';\nimport { ProjectileModel } from './game/Domain/projectile';\n\nimport { createPlayer } from './game/factories/player';\nimport { createBullet } from './game/factories/bullet';\n\nimport { system } from './game';\n\nimport { ON_START_GAME, ON_START_ENGINE, ON_STOP_ENGINE } from './events';\nimport { keys } from './engine/utils';\nimport { SfxLibrary, Songs, SongLibrary } from './game/catalogue';\n\ninterface State {\n  epoch:    number;\n  player:   CharacterModel;\n  bullet1:  ProjectileModel;\n  bullet2:  ProjectileModel;\n}\n\nclass App extends React.PureComponent<{}, State> {\n  private handler: number | undefined;\n\n  private player  = createPlayer(system, 'Odin');\n  private bullet1 = createBullet(system, 'Bullet of Destiny');\n  private bullet2 = createBullet(system, 'Bullet of Greater Truth');\n\n  constructor(props: {}) {\n    super(props);\n\n    this.gameAudioInitialize();\n\n    system.events.registerListener(ON_START_GAME,    this.startNewGame);\n    system.events.registerListener(ON_START_ENGINE,  this.start);\n    system.events.registerListener(ON_STOP_ENGINE,   this.stop);\n  }\n\n  state = {\n    epoch:   system.epoch,\n    player:  system.getEntityModel<CharacterModel>(this.player),\n    bullet1: system.getEntityModel<ProjectileModel>(this.bullet1),\n    bullet2: system.getEntityModel<ProjectileModel>(this.bullet2),\n  }\n  \n\n  componentDidMount() {\n    this.moUntWOrld();\n\n    this.start();\n  }\n\n  componentWillUnmount() {\n    this.gameAudioCleanup();\n\n    system.events.unRegisterListener(ON_START_GAME,  this.startNewGame)\n    system.events.registerListener(ON_START_ENGINE,  this.start);\n    system.events.registerListener(ON_STOP_ENGINE,   this.stop);\n\n    this.stop();\n\n    delete this.handler;\n  }\n\n  gameAudioInitialize = () => {\n\n    keys(SongLibrary).forEach((key: string | number) => {\n      system.audio.registerSong(`${key}`, { ...SongLibrary[key], volume: 0.6 })\n    });\n\n    keys(SfxLibrary).forEach((key: string | number) => {\n      system.audio.registerSound(`${key}`, { ...SfxLibrary[key], volume: 0.3 })\n    });\n  }\n\n  gameAudioCleanup = () => {\n\n    keys(SongLibrary).forEach((key: string | number) => {\n      system.audio.unRegisterSong(`${key}`)\n    });\n    \n    keys(SfxLibrary).forEach((key: string | number) => {\n      system.audio.unRegisterSound(`${key}`)\n    });\n  }\n\n  moUntWOrld = () => {\n    this.setState({ epoch: system.epoch });\n  }\n\n  tick = () => {\n    system.step();\n\n    this.setState(_ => ({\n      epoch:   system.epoch,\n      player:  system.getEntityModel(this.player),\n      bullet1: system.getEntityModel<ProjectileModel>(this.bullet1),\n      bullet2: system.getEntityModel<ProjectileModel>(this.bullet2),\n    }));\n  }\n\n  startNewGame = () => {\n    window.location.assign('/game')\n  }\n\n  start = () => {\n    this.stop();\n\n    this._update();\n  }\n\n  _update = () => {\n    this.handler = requestAnimationFrame(this._update);\n\n    this.tick();\n  }\n\n  stop = () => {\n    if (this.handler) cancelAnimationFrame(this.handler);\n  }\n\n  save = () => {\n    system.storage.saveGame();\n  }\n\n  load = () => {\n    this.stop();\n\n    system.storage.loadGame();\n\n    this.moUntWOrld();\n\n    this.start();\n  }\n\n  restart = () => {\n    window.location.assign('/menu');\n  }\n\n  render() {\n    return (\n      <Router>\n        <div className=\"App container with-title is-center is-dark\">\n          <label className=\"title\">Galaga.ts</label>\n\n          {/* <Route exact path=\"/\" render={(props) =>\n            <Intro\n              onPlayerInput={this.startNewGame}\n              {...this.state}\n              {...props}\n            />\n          } /> */}\n\n          <Route exact path=\"/\" render={(props) =>\n            <Menu\n              system={system}\n              {...this.state}\n              {...props}\n            />\n          } />\n\n          <Route path=\"/game\" render={(props) =>\n            <Game\n              system={system}\n              onRestart={this.restart}\n              {...this.state}\n              {...props}\n            />\n          } />\n\n          <Route path=\"/end\" render={(props) =>\n            <Outro\n              system={system}\n              {...this.state}\n              {...props}\n            />\n          } />\n\n          <DevScreen\n            system={system}\n            onStart={this.start}\n            onStop={this.stop}\n            onTick={this.tick}\n            onSave={this.save}\n            onLoad={this.load}\n          />\n        </div>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport './index.css';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}